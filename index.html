<!doctype html><html lang=ko><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>김영천 블로그</title><meta name=google-site-verification content="H-82h77dqtsTaOMUy7Ygl0t2MKqA_dYxGjcE-5A-Vhk"><meta property="og:title" content="김영천 블로그"><meta name=twitter:title content="김영천 블로그"><meta name=author content="YeongCheon Kim"><meta property="og:site_name" content="김영천 블로그"><meta property="og:url" content="https://yeongcheon.github.io/"><meta property="og:type" content="website"><meta property="og:image" content="https://yeongcheon.github.io/images/profile_no_background.png"><meta name=twitter:image content="https://yeongcheon.github.io/images/profile_no_background.png"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.101.0"><link href=/index.xml rel=alternate type=application/rss+xml title="김영천 블로그"><link href=/index.xml rel=feed type=application/rss+xml title="김영천 블로그"><link rel=stylesheet href=/css/style.css media=all><link rel=stylesheet href=/css/syntax.css media=all><link rel=stylesheet href=/css/custom.css media=all><script src=/js/script.js></script>
<script src=/js/custom.js></script>
<script defer src=/js/fontawesome.js></script></head><body><header class=site-header><nav class=site-navi><h1 class=site-title><a href=/><img src=/images/profile_no_background.png>김영천 블로그 - 게을러지고 싶으면 공부해야 합니다.</a></h1><ul class=site-navi-items><li class=site-navi-item-tags><a href=/tags/ title=Tags>Tags</a></li><li class=site-navi-item-archives><a href=/posts/ title=Archives>Archives</a></li><li class=site-navi-item-about><a href=/about/ title=About>About</a></li></ul></nav></header><hr class=site-header-bottom><div class=main role=main><section class="list home-list"><article class=article><a href=/posts/2022-07-23-action-in-rust-review/ class=article-titles><h2 class=article-title>한 줄 한 줄 짜면서 익히는 러스트 프로그래밍 책 리뷰</h2><h3 class=article-subtitle>도서 증정 이벤트에 당첨된 기념으로 처음으로 독후감을 써볼까 한다.</h3></a><ul class=article-meta><li class=article-meta-date><time>July 23, 2022</time></li><li class=article-meta-tags><a href=/tags/rust/><i class="fas fa-tag"></i>
rust
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/%EB%9F%AC%EC%8A%A4%ED%8A%B8/><i class="fas fa-tag"></i>
러스트
</a>&nbsp;</li></ul><div class=article-content>서론 우선 나는 웹 개발자다. 어렸을때 C언어를 겉핡기로 배우면서 프로그래밍의 기초를 배우고 이후 php를 통해 처음으로 웹 개발을 접하게 되었다. 그 후 자바와 스프링을 배우면서 웹 개발을 본격적으로 했지만 항상 JVM 위에서 돌아가고 보통의 exe 파일이 아닌 jar(또는 war) 파일이 빌드 결과물로 나오는게 내심 복잡하고 어렵게 느껴졌다. 그러던 즈음 구글에서 Go언어를 발표했다. 문법도 간결하고 성능도 준수하고 JVM같은 가상머신이 필요 없는 빌드 결과물이 상당히 매력적으로 느껴졌다. 하지만 당시나 지금이나 Go언어는 자바/스프링 진영보다 국내 시장 점유율이 낮았기 때문에 Go언어를 사용해 일을 할 기회는 많이 없었지만 개인적인 토이 프로젝트나 업무에서 가볍게 쓸 프로그램을 짤 때는 항상 우선순위로 염두해두는 언어가 되었다.</div><div class=article-readmore><a href=/posts/2022-07-23-action-in-rust-review/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2022-05-08-android-cross-app-scripting/ class=article-titles><h2 class=article-title>Android Cross-App Scripting 해결하기</h2><h3 class=article-subtitle>웹뷰 기반 하이브리드 앱에서 크로스 앱 스크립팅 문제 해결하기</h3></a><ul class=article-meta><li class=article-meta-date><time>May 8, 2022</time></li><li class=article-meta-tags><a href=/tags/android/><i class="fas fa-tag"></i>
android
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/security/><i class="fas fa-tag"></i>
security
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/%EB%B3%B4%EC%95%88/><i class="fas fa-tag"></i>
보안
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/%ED%81%AC%EB%A1%9C%EC%8A%A4%EC%95%B1%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8C%85/><i class="fas fa-tag"></i>
크로스앱스크립팅
</a>&nbsp;</li></ul><div class=article-content>문제 운영중인 안드로이드 앱을 플레이스토어에 업데이트 하다가 구글 측에서 교차 앱 스크립팅 취약정 문제가 있다는 메일을 받았습니다. 구글 측에서 제공한 가이드대로 조치를 취했는데도 여전히 문제가 있다는 리포트를 받아서 문제의 원인 해결방법을 기록하고자 합니다.
원인 FCM을 통해 전달된 URL이 문제였습니다(링크 참고). 운영 중인 앱은 FCM을 통해 전달받은 URL을 별도의 조치 없이 그대로 webview에서 로드하는 방식으로 운영되고 있었습니다. 이 URL은 저희 측에서 만든 서버에서 보내주는 URL이라 별도로 유효성 검사 없이 제공해도 문제가 없다고 판단해서 이러한 방식을 선택했는데 이 부분이 문제였습니다.</div><div class=article-readmore><a href=/posts/2022-05-08-android-cross-app-scripting/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-12-26-spring-aop-superclass/ class=article-titles><h2 class=article-title>Spring Pointcut 표현식에 부모 클래스 표현하기</h2><h3 class=article-subtitle>Spring AOP에서 사용하는 Pointcut 표현식을 이용해 특정 클래스를 상속하는 모든 클래스를 표현하는 방법에 대해 알아봅니다.</h3></a><ul class=article-meta><li class=article-meta-date><time>December 26, 2021</time></li><li class=article-meta-tags><a href=/tags/spring/><i class="fas fa-tag"></i>
spring
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/aop/><i class="fas fa-tag"></i>
aop
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/pointcut/><i class="fas fa-tag"></i>
pointcut
</a>&nbsp;</li></ul><div class=article-content>들어가며 이 문서는 기본적으로 Spring AOP에 대해 사전 지식이 있다는 전제 하에 작성되었습니다.
요구사항 Fruit 클래스를 상속받는 Apple, Banana 클래스가 있습니다. Apple 또는 Banana 클래스를 반환하는 모든 메서드 마지막에 로그를 남기는 기능을 작성하고자 합니다.
Basic Code Model 1 2 3 4 5 6 7 8 9 10 11 12 13 package dev.yeongcheon.example.aop.model abstract class Fruit( val name: String ) class Apple: Fruit( name = "apple" ) class Banana: Fruit( name = "banana" ) Controller 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 package dev.</div><div class=article-readmore><a href=/posts/2021-12-26-spring-aop-superclass/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-10-03-angular-reuse-strategy/ class=article-titles><h2 class=article-title>angular route reuse strategy</h2><h3 class=article-subtitle>Angular의 RouteReuseStrategy가 어떻게 동작하는지 알아봅니다.</h3></a><ul class=article-meta><li class=article-meta-date><time>October 3, 2021</time></li><li class=article-meta-tags><a href=/tags/angular/><i class="fas fa-tag"></i>
angular
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/router/><i class="fas fa-tag"></i>
router
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/routereusestrategy/><i class="fas fa-tag"></i>
RouteReuseStrategy
</a>&nbsp;</li></ul><div class=article-content>Intro 웹앱을 개발하다보면 list->detail 패턴의 구조를 흔하게 작성하게 됩니다. list-detail 패턴이란 목록(list)에서 원하는 컨텐츠를 탐색 후 해당 컨텐츠의 상세한 정보를 보는 화면(detail)로 이동하는 방식을 말합니다. 이 때 detail 화면에서 뒤로 가기를 이용해 목록 화면으로 돌아올 경우 Angular는 해당 화면을 구성하는 컴포넌트를 처음부터 다시 생성(ngOnInit 실행)합니다. 이럴 경우엔 다음과 같은 문제가 발생합니다.
컴포넌트를 다시 생성하기 때문에 성능상 좋지 못합니다. 컴포넌트를 다시 그리기 때문에 로딩 화면이 보여지거나 스크롤 위치를 기억하지 등 유저 경험에 악영향을 미칩니다.</div><div class=article-readmore><a href=/posts/2021-10-03-angular-reuse-strategy/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-09-08-http-call-in-docker-container/ class=article-titles><h2 class=article-title>도커 컨테이너 안에서 외부 URL 호출하기</h2><h3 class=article-subtitle>도커 컨테이너 내부에서 외부 URL을 호출할 경우 발생하는 에러와 그 해결법을 알아봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>September 8, 2021</time></li><li class=article-meta-tags><a href=/tags/docker/><i class="fas fa-tag"></i>
docker
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/x509/><i class="fas fa-tag"></i>
x509
</a>&nbsp;</li></ul><div class=article-content>도커 컨테이너 내부에서 외부 URL을 호출해야 하는 경우가 종종 있습니다(Ex: 네이버 API 호출). 평소에는 아무 생각없이 불러오던 URL이 도커 컨테이너에서 사용하면 에러가 발생하는 경우가 있습니다. 에러 메세지는 x509: certificate signed by unknown authority 대충 이런 모양인데 이는 도커 컨테이너에 사용한 이미지의 TLS 인증서에 문제가 있음을 의미합니다.
우분투 이미지 기반 컨테이너를 기준으로 해결방법은 아래와 같습니다. 사용하고 있는 Dockerfile 에 다음 내용을 입력합니다.
1 2 3 RUN apt update RUN apt install -y ca-certificates RUN update-ca-certificates 컨테이너를 다시 빌드하면 이제 에러 없이 URL을 정상적으로 호출하는걸 확인할 수 있습니다.</div><div class=article-readmore><a href=/posts/2021-09-08-http-call-in-docker-container/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-07-23-angular-ssr-chrome-inspect/ class=article-titles><h2 class=article-title>angular universal 메모리 누수 개선하기 - 003</h2><h3 class=article-subtitle>Chrome Inspect를 사용해서 Angular Universal 메모리 누수 개선하기</h3></a><ul class=article-meta><li class=article-meta-date><time>July 23, 2021</time></li><li class=article-meta-tags><a href=/tags/node/><i class="fas fa-tag"></i>
node
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/angular/><i class="fas fa-tag"></i>
angular
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/chrome/><i class="fas fa-tag"></i>
chrome
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/inspect/><i class="fas fa-tag"></i>
inspect
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/node/><i class="fas fa-tag"></i>
node
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/memory-leak/><i class="fas fa-tag"></i>
memory-leak
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/promise/><i class="fas fa-tag"></i>
promise
</a>&nbsp;</li></ul><div class=article-content>앵귤러 기반 웹사이트를 개발하면서 발생한 메모리 누수의 다양한 원인들과 그 해결법을 기록합니다.
들어가며 이번 문서에서는 Chrome Inspect를 이용해서 서버 사이드 렌더링 시 발생하는 메모리 누수를 확인하고 이를 수정하는 방법에 대해 알아봅니다. 이 문서는 Angular Universal에 대해 기본적인 이해가 있다는 것을 전제로 작성되었습니다.
앱 작성 직접 밑바닥부터 코드를 작성해가며 문제를 재현해봅시다.
앵귤러 앱 생성 다음 명령어를 이용해 앵귤러 앱을 생성해줍니다.
1 ng new sample universal 모듈 추가 다음 명령어를 이용해 universal 관련 모듈을 추가해줍니다.</div><div class=article-readmore><a href=/posts/2021-07-23-angular-ssr-chrome-inspect/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-07-15-angular-memory-leak002/ class=article-titles><h2 class=article-title>angular universal 메모리 누수 개선하기 - 002</h2><h3 class=article-subtitle>rxjs의 Observable 관련 메모리 누수 버그를 고쳐봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>July 15, 2021</time></li><li class=article-meta-tags><a href=/tags/angular/><i class="fas fa-tag"></i>
angular
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/node/><i class="fas fa-tag"></i>
node
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/memory-leak/><i class="fas fa-tag"></i>
memory-leak
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/observable/><i class="fas fa-tag"></i>
observable
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/ngneat/until-destroy/><i class="fas fa-tag"></i>
ngneat/until-destroy
</a>&nbsp;</li></ul><div class=article-content>앵귤러 기반 웹사이트를 개발하면서 발생한 메모리 누수의 다양한 원인들과 그 해결법을 기록합니다.
들어가며 이번 문서에서는 rxjs 쓰다보면 흔하게 접할 수 있는 메모리 누수에 대해 알아보고 eslint와 until-destroy를 이용해 메모리 누수를 원천적으로 막을 수 있는 방법에 대해 알아봅시다. 이 문서는 rxjs, eslint에 대해 기본적인 이해가 있다는 것을 전제로 작성되었습니다.
Bad Case 다음은 흔하게 작성하는 앵귤러 컴포넌트 코드입니다.
1 2 3 4 5 6 7 8 9 10 11 12 @Component({ selector: 'app-a', templateUrl: '.</div><div class=article-readmore><a href=/posts/2021-07-15-angular-memory-leak002/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-07-11-angular-memory-leak001/ class=article-titles><h2 class=article-title>angular universal 메모리 누수 개선하기 - 001</h2><h3 class=article-subtitle>SSR 동작 시 발생하는 heap out of memory 수정하기</h3></a><ul class=article-meta><li class=article-meta-date><time>July 11, 2021</time></li><li class=article-meta-tags><a href=/tags/angular/><i class="fas fa-tag"></i>
angular
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/node/><i class="fas fa-tag"></i>
node
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/memory-leak/><i class="fas fa-tag"></i>
memory-leak
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/static/><i class="fas fa-tag"></i>
static
</a>&nbsp;</li></ul><div class=article-content>앵귤러 기반 웹사이트를 개발하면서 발생한 메모리 누수의 다양한 원인들과 그 해결법을 기록합니다.
들어가며 부끄럽지만 앵귤러 기반 웹 프로젝트를 진행하며 메모리 누수같은 문제는 사실 전혀 신경을 안(못)쓰고 있었습니다. 어차피 사용자 브라우저에서 돌아가니깐 새로고침만 하면 해당 페이지의 메모리는 초기화될테니 속도만 느리지 않다면 된다는 생각이었지요. 당연히 이는 크게 잘못된 생각이었고 서버사이드 렌더링(이하 SSR)를 적용하면서 문제는 상당히 심각하게 흘러갑니다. 지금부터 제가 개발하면서 만나본 다양한 메모리 누수(memory leak) 문제를 살펴보고 그 해결법을 기록하고자 합니다.</div><div class=article-readmore><a href=/posts/2021-07-11-angular-memory-leak001/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-05-07-covid-visitor-list/ class=article-titles><h2 class=article-title>코로나 방문자 수기명부 개인정보 수집제공 동의서 양식</h2><h3 class=article-subtitle>코로나 방문자 수기명부 개인정보 수집제공 동의서</h3></a><ul class=article-meta><li class=article-meta-date><time>May 7, 2021</time></li><li class=article-meta-tags><a href=/tags/%EC%BD%94%EB%A1%9C%EB%82%98/><i class="fas fa-tag"></i>
코로나
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/covid/><i class="fas fa-tag"></i>
covid
</a>&nbsp;</li></ul><div class=article-content><p>자영업을 하고 계시는 부모님 의뢰로 <a href="https://docs.google.com/spreadsheets/d/12XYfOrZC9q3LJL7BpcB4hSCKqBYYENXHZOyd0S2xfaU/edit#gid=0">코로나 방문자 수기명부 개인정보 수집제공 동의서 양식</a>을 작성해서 공유합니다.</p></div><div class=article-readmore><a href=/posts/2021-05-07-covid-visitor-list/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-02-05-cloud-function-context-problem/ class=article-titles><h2 class=article-title>cloud function 호출 시 context의 중요성에 대해 알아보자.</h2><h3 class=article-subtitle>cloud function을 http trigger로 호출 시 context를 잘못 할당할 경우 발생하는 문제에 대해 알아봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>February 5, 2021</time></li><li class=article-meta-tags><a href=/tags/gcp/><i class="fas fa-tag"></i>
gcp
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/cloudfunction/><i class="fas fa-tag"></i>
cloudfunction
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/golang/><i class="fas fa-tag"></i>
golang
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/context/><i class="fas fa-tag"></i>
context
</a>&nbsp;</li></ul><div class=article-content>예전 글에서 언급한 imagick-cf를 테스트 하는 도중 마주한 알 수 없는 특이한 오류와 이를 해결했던 과정을 기록합니다.
문제 url을 통해서 함수를 실행하면 최초 실행 후 일정 시간동안은 몇번을 호출하든 결과가 정상적으로 반환합니다. 하지만 이후 500 에러를 반환하기 시작합니다. 심지어 이 전에 정상적으로 반환했던 url을 그대로 호출해도 500 error를 반환하는 어처구니 없는 모습을 보여줍니다. 게다가 500 에러를 반환하는 경우엔 로그조차 남지 않아서 원인을 지레짐작으로 파악할 수 밖에 없는 상황입니다. 물론 local test시에는 매우 잘 동작합니다.</div><div class=article-readmore><a href=/posts/2021-02-05-cloud-function-context-problem/>Read more...</a></div><div class=article-floatclear></div></article></section><ul class="pagination pagination-default"><li class="page-item disabled"><a aria-disabled=true aria-label=First class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Previous class=page-link role=button tabindex=-1><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a aria-current=page aria-label="Page 1" class=page-link role=button>1</a></li><li class=page-item><a href=/page/2/ aria-label="Page 2" class=page-link role=button>2</a></li><li class=page-item><a href=/page/3/ aria-label="Page 3" class=page-link role=button>3</a></li><li class=page-item><a href=/page/4/ aria-label="Page 4" class=page-link role=button>4</a></li><li class=page-item><a href=/page/5/ aria-label="Page 5" class=page-link role=button>5</a></li><li class=page-item><a href=/page/2/ aria-label=Next class=page-link role=button><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/page/5/ aria-label=Last class=page-link role=button><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div><div class=site-footer><div class=copyright>&copy; Copyright 2020 YeongCheon</div><ul class=site-footer-items><li class=site-footer-item-rsslink><a href=/index.xml type=application/rss+xml target=_blank title=RSS><i class="fas fa-rss"></i></a></li><li class=site-footer-item-about><a href=/about/ title=About>About</a></li></ul><div class=powerdby>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://github.com/taikii/whiteplain>Whiteplain</a></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-0YT8RHXZR3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0YT8RHXZR3",{anonymize_ip:!1})}</script></body><script data-ad-client=ca-pub-4599234083355765 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></html>