<!doctype html><html lang=ko><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>tinode series.003 - API document - 김영천 블로그</title><meta name=Description content="게을러지고 싶으면 공부해야 합니다."><meta property="og:title" content="tinode series.003 - API document"><meta property="og:description" content="매번 영어문서 보기 빡쳐서 직접 번역기 돌려가며 쓰는 번역본. 번역기와 의역, 오역 범벅입니다. 가급적이면 공식 문서를 보세요. Server API How it works? Tinode는 IM 라우"><meta property="og:type" content="article"><meta property="og:url" content="https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/"><meta property="og:image" content="https://yeongcheon.github.io/images/profile_no_background.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-26T00:00:00+09:00"><meta property="article:modified_time" content="2021-04-11T18:25:14+09:00"><meta property="og:site_name" content="김영천 블로그"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://yeongcheon.github.io/images/profile_no_background.png"><meta name=twitter:title content="tinode series.003 - API document"><meta name=twitter:description content="매번 영어문서 보기 빡쳐서 직접 번역기 돌려가며 쓰는 번역본. 번역기와 의역, 오역 범벅입니다. 가급적이면 공식 문서를 보세요. Server API How it works? Tinode는 IM 라우"><meta name=application-name content="김영천 블로그"><meta name=apple-mobile-web-app-title content="김영천 블로그"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/><link rel=prev href=https://yeongcheon.github.io/posts/2020-06-12-grpc-for-web/><link rel=next href=https://yeongcheon.github.io/posts/2020-09-06-kotlin-spring-exception-rollback/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><meta name=google-site-verification content="H-82h77dqtsTaOMUy7Ygl0t2MKqA_dYxGjcE-5A-Vhk"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"tinode series.003 - API document","inLanguage":"ko","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/yeongcheon.github.io\/posts\/2020-07-26-tinode-chat-api-doc-translate-ko\/"},"image":["https:\/\/yeongcheon.github.io\/images\/profile_no_background.png"],"genre":"posts","keywords":"tinode, golang, chat","wordcount":23766,"url":"https:\/\/yeongcheon.github.io\/posts\/2020-07-26-tinode-chat-api-doc-translate-ko\/","datePublished":"2020-07-26T00:00:00+09:00","dateModified":"2021-04-11T18:25:14+09:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"yeongcheon"},"description":""}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1746942287310414" crossorigin=anonymous></script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="김영천 블로그"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/profile_no_background.png data-srcset="/images/profile_no_background.png, /images/profile_no_background.png 1.5x, /images/profile_no_background.png 2x" data-sizes=auto alt=/images/profile_no_background.png title=/images/profile_no_background.png>김영천 블로그<span class=header-title-post><sup>"게을러지고 싶으면 공부해야 합니다."</sup></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="테마 변경">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="김영천 블로그"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/images/profile_no_background.png data-srcset="/images/profile_no_background.png, /images/profile_no_background.png 1.5x, /images/profile_no_background.png 2x" data-sizes=auto alt=/images/profile_no_background.png title=/images/profile_no_background.png>김영천 블로그<span class=header-title-post><sup>"게을러지고 싶으면 공부해야 합니다."</sup></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="테마 변경">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>목차</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">tinode series.003 - API document</h1><h2 class=single-subtitle>tinode chat API document 한국어 번역본</h2><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/yeongcheon title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>yeongcheon</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-07-26>2020-07-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;23766 단어&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;읽는데 약 48분&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>목차</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#headline-1>Server API</a><ul><li><a href=#headline-2>How it works?</a></li><li><a href=#headline-3>General Considerations</a></li><li><a href="#Connecting to the Server">Connecting to the Server</a><ul><li><a href=#headline-5>gRPC</a></li><li><a href=#headline-6>WebSocket</a></li><li><a href=#headline-7>Long Polling</a></li><li><a href=#headline-8>Out of Band Large Files</a></li><li><a href=#headline-9>Running Behind a Reverse Proxy</a></li></ul></li></ul></li><li><a href=#headline-10>Users</a><ul><li><a href=#Authentication>Authentication</a><ul><li><a href=#headline-12>Creating an Account</a></li><li><a href=#headline-13>Logging in</a></li><li><a href="#Changing Authentication Parameters">Changing Authentication Parameters</a></li><li><a href="#resetting a password">Resetting a Password, i.e. "Forgot Password"</a></li></ul></li><li><a href=#headline-16>Suspending a User</a></li><li><a href=#headline-17>Credential Validation</a></li><li><a href="#Access Control">Access Control</a></li></ul></li><li><a href=#headline-19>Topics</a><ul><li><a href=#headline-20><code>me</code> Topic</a></li><li><a href=#fnd><code>fnd</code> and Tags: Finding Users and Topics</a><ul><li><a href="#Query Language">Query Language</a><ul><li><a href=#headline-23>Some examples:</a></li></ul></li><li><a href=#headline-24>Incremental Updates to Queries</a></li><li><a href=#headline-25>Query Rewrite</a></li><li><a href=#headline-26>Possible Use Cases</a></li></ul></li><li><a href=#headline-27>Peer to Peer Topics</a></li><li><a href=#headline-28>Group Topics</a></li><li><a href=#headline-29><code>sys</code> Topic</a></li></ul></li><li><a href=#headline-30>Using Server-Issued Message IDs</a></li><li><a href=#headline-31>User Agent and Presence Notifications</a></li><li><a href="#Public and Private Fields">Public and Private Fields</a><ul><li><a href=#headline-33>Public</a></li><li><a href=#headline-34>Private</a></li></ul></li><li><a href="#Format of Content">Format of Content</a></li><li><a href="#Out-of-Band Handling of Large Files">Out-of-Band Handling of Large Files</a><ul><li><a href=#headline-37>Uploading</a></li><li><a href=#headline-38>Downloading</a></li></ul></li><li><a href=#headline-39>Push Notifications</a><ul><li><a href=#headline-40>Tinode Push Gateway</a></li><li><a href=#headline-41>Google FCM</a></li><li><a href=#headline-42>Stdout</a></li></ul></li><li><a href=#headline-43>Messagse</a><ul><li><a href=#headline-44>Client to Server Messages</a><ul><li><a href=#headline-45><code>{hi}</code></a></li><li><a href=#acc><code>{acc}</code></a></li><li><a href=#login><code>{login}</code></a></li><li><a href=#sub><code>{sub}</code></a></li><li><a href=#headline-49><code>{leave}</code></a></li><li><a href=#pub><code>{pub}</code></a></li><li><a href=#headline-51><code>{get}</code></a></li><li><a href=#headline-52><code>{set}</code></a></li><li><a href=#headline-53><code>{del}</code></a></li><li><a href=#headline-54><code>{note}</code></a></li></ul></li><li><a href=#headline-55>Server to Client Messages</a><ul><li><a href=#data><code>{data}</code></a></li><li><a href=#headline-57><code>{ctrl}</code></a></li><li><a href=#headline-58><code>{meta}</code></a></li><li><a href=#headline-59><code>{pres}</code></a></li><li><a href=#headline-60><code>{info}</code></a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><p>매번 <a href=https://github.com/tinode/chat/blob/master/docs/API.md>영어문서</a> 보기 빡쳐서 직접 번역기 돌려가며 쓰는 번역본. <del>번역기와 의역, 오역 범벅입니다.</del> 가급적이면 <a href=https://github.com/tinode/chat/blob/master/docs/API.md>공식 문서</a>를 보세요.</p><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Server API</h2><div id=outline-text-headline-1 class=outline-text-2><div id=outline-container-headline-2 class=outline-3><h3 id=headline-2>How it works?</h3><div id=outline-text-headline-2 class=outline-text-3><p>Tinode는 IM 라우터이자 스토어입니다. 발행-구독 모델 컨셉을 대략적으로 따릅니다.</p><p>서버는 세션, 사용자, 그리고 토픽을 연결합니다. 세션은 클라이언트 프로그램과 서버 간의 네트워크 연결을 의미합니다. 사용자는 세션을 서버에 연결하는 사람을 의미합니다. 토픽은 세션들끼리 콘텐츠를 주고받는 통신 채널입니다.</p><p>사용자가 토픽은 각각 고유한 ID가 할당됩니다. 사용자 ID는 'usr' 문자로 시작하는 base64-URL 인코딩 6비트 랜덤 문자로 이루어져 있습니다(예: usr2il9suCbuko). 토픽 ID는 아래에서 설명합니다.</p><p>모바일 또는 웹 어플리케이션 클라이언트는 웹소켓 또는 long pulling 방식으로 서버에 연결하여 세션을 생성합니다. 대부분 작업을 수행하기 위해선 클라이언트 인증이 필요합니다. 클라이언트는 {login} 패킷을 전송하여 세션을 인증합니다. 좀 더 자세한 내용은 <a href=#Authentication>인증 섹션</a>을 참고하세요. 인증되면 클라이언트는 나중에 인증에 사용할 토큰을 발급받습니다. 동일한 사용자가 여러 세션을 동시에 설정할 수 있습니다. 로그아웃은 지원하지 않습니다. (필요하지도 않고요).</p><p>세션이 설정되면 사용자는 토픽을 통해 다른 사용자와 통신을 시작할 수 있습니다. 다음과 같은 토픽들을 사용할 수 있습니다.</p><ul><li><code>me</code> 는 자기 자신의 프로필을 관리하고 다른 토픽에 대한 알람을 받을 수 있는 토픽입니다. <code>me</code> 토픽은 모든 사용자가 가지고 있습니다.</li><li><code>fnd</code> 토픽은 다른 사용자나 토픽을 찾을 때 사용합니다. <code>fnd</code> 토픽 또한 모든 사용자가 가지고 있습니다.</li><li>Peer to Peer 토픽은 두 사용자 간 1:1 통신을 위한 토픽입니다. 각 사용자는 토픽 이름을 상대방의 ID로 인지합니다. 즉, 'usr' 문자로 시작하는 base64-URL 인코딩 6비트 랜덤 문자(예: usr2il9suCbuko)로 인지합니다.</li><li>그룹 토픽은 여러 사용자 간 통신을 위한 토픽입니다. 이 토픽의 이름은 'grp'로 시작하며 11자리의 pseudo 무작위 숫자로 이루어져 있습니다(예: <code>grpYiqEXb4QY6s</code>). 그룹 토픽은 반드시 명시적으로 작성해야 합니다.</li></ul><p>세션은 <code>{sub}</code> 패킷을 전송하여 토픽에 참여합니다. <code>{sub}</code> 패킷은 세 가지 기능을 제공합니다. 새 토픽을 만들고, 사용자 토픽을 구독하고, 세션을 토픽에 연결하는 기능을 제공합니다. 더 자세한 내용은 아래 <a href=#sub><code>{sub}</code></a> 섹션을 참고하세요.</p><p>세션이 토픽에 연결되면, 사용자는 <code>{pub}</code> 패킷을 이용해 콘텐츠를 생성을 시작합니다. 콘텐츠는 다른 세션들에게 <code>{data}</code> 패킷 형태로 전송됩니다.</p><p>사용자는 <code>{get}</code>, <code>{set}</code> 패킷을 이용하여 쿼리를 요청하거나, 토픽의 메타데이터를 수정할 수 있습니다.</p><p>토픽의 설명 변경 또는 다른 사용자의 토픽 참여, 탈퇴 같은 토픽 메타데이터 변경은 <code>{pres}</code> (presence) 패킷을 이용하여 실시간으로 세션에 전송합니다. <code>{pres}</code> 패킷은 연관있는 토픽 또는 <code>me</code> 토픽으로 전송됩니다.</p><p>사용자의 <code>me</code> 토픽이 온라인 상태가 되면(예: 인증된 세션이 <code>me</code> 토픽과 연결될 때) <code>{pres}</code> 패킷이 온라인 된 사용자와 Peer to Perr 형태로 연결된 모든 사용자의 <code>me</code> 토픽에 전송됩니다.</p></div></div><div id=outline-container-headline-3 class=outline-3><h3 id=headline-3>General Considerations</h3><div id=outline-text-headline-3 class=outline-text-3><p>타임스탬프는 항상 <a href=https://tools.ietf.org/html/rfc3339>RFC 3339</a> 형식을 따르는 문자열 형태이며, 밀리 세컨드까지 표시되고 타임존은 항상 UTC를 기준으로 한다. 예: <code>"2015-10-06T18:07:29.841Z"</code></p><p>앞으로 이 문서에서 base64 인코딩이 언급된다면, 이는 padding characters가 stripped된 base64 URL인코딩을 의미합니다. <a href=https://tools.ietf.org/html/rfc4648>RFC 4648</a> 문서를 참고하세요.</p><p><code>{data}</code> 패킷은 서버에서 생성한 순차적 ID를 가집니다. ID는 1부터 시작하여 각 메세지마다 1씩 증가하는 10진수 형태의 숫자입니다. 각 ID는 토픽별로 고유한 값임을 보장합니다. 요청에 대한 응답을 연동하기 위해서 클라이언트는 서버에 할당된 모든 패캣에 메세지 ID를 할당할 수 있습니다. 이 ID는 클라이언트 측에서 정의한 고유한 문자열 값입니다. 클라이언트는 이 ID값을 각 세션별로 고유하게(unique) 만들어야 합니다. 클라이언트가 할당한 아이디는 서버에서는 신경쓰지 않으며, 클라이언트에 그대로 반환됩니다.</p></div></div><div id="outline-container-Connecting to the Server" class=outline-3><h3 id="Connecting to the Server">Connecting to the Server</h3><div id="outline-text-Connecting to the Server" class=outline-text-3><p>네트워크에서 서버에 연결하는 방법은 3가지가 있습니다. 웹 소켓, 롱 폴링, 그리고 <a href=https://grpc.io/>gRPC</a>입니다.</p><p>클라이언트가 웹 소켓이나 롤 폴링같은 방식으로 HTTP(S)를 통해 서버와 연결 됐을 때, 서버는 다음과 같은 endpoint를 제공합니다.</p><ul><li><code>/v0/channels</code> 는 웹 소켓 연결 시 사용됩니다.</li><li><code>/v0/channels/lp</code> 는 롱 폴링 연결 시 사용됩니다.</li><li><code>/v0/file/u</code> 는 파일 업로드 시 사용됩니다.</li><li><code>/v0/file/s</code> 는 파일 다운로드에 사용됩니다.</li></ul><p><code>v0</code> 은 API 버전을 나타냅니다(현재 버전 0). 모든 HTTP(S) 요청은 API 키가 포함되어 있어야 합니다. 서버는 아래의 순서대로 API 키를 확인합니다.</p><ul><li>HTTP header <code>X-Tinode-APIKey</code></li><li>URL query parameter ~apikey~(/v0/file/s/abcdefg.jpeg?apikey=…)</li><li>Form value <code>apikey</code></li><li>Cookie <code>apikey</code></li></ul><p>편의상 모든 데모 앱에는 기본 API 키가 포함되어 있습니다. <a href=https://github.com/tinode/chat/tree/master/keygen><code>keygen</code> 유틸리티</a>를 사용하여 프로덕션용 고유 키를 생성하세요.</p><p>서버에 연결되면 클라이언트는 서버에 <code>{hi}</code> 메세지를 전송해야 합니다. 서버는 이에 성공 또는 에러를 나타내는 <code>{ctrl}</code> 메세지로 응답합니다. 응답의 <code>param</code> 필드는 서버의 프로토콜 버전 <code>"params": {"ver":"0,15"}</code> 를 포함하며, 다른 값을 포함할 수 있습니다.</p><div id=outline-container-headline-5 class=outline-4><h4 id=headline-5>gRPC</h4><div id=outline-text-headline-5 class=outline-text-4><p><a href=https://github.com/tinode/chat/blob/master/pbx/model.proto>proto file</a>에서 gRPC API가 어떻게 정의되어 있는지 확인하세요. gRPC API는 루트 사용자가 다른 사용자들 대신해서 메세지를 보내거나 사용자를 삭제하는 등 이 문서에서 설명하는 내용보다 좀 더 많은 기능을 가지고 있습니다.</p><p>protoubf의 message의 <code>bytes</code> 필드에는 JSON 인코딩 UTF-8 콘텐츠가 필요합니다. 예를 들어, 문자열은 반드시 UTF-8 bytes로 변환되기 전에 따옴표로 감싸져 있어야 합니다.(Go: <code>[]byte("\"\some string"")</code>), (Python 3: <code>'"another string".encode('utf-8')'</code>)</p></div></div><div id=outline-container-headline-6 class=outline-4><h4 id=headline-6>WebSocket</h4><div id=outline-text-headline-6 class=outline-text-4><p>모든 메세지들은 각 메세지마다 하나의 텍스트 프레임으로 전송됩니다. 바이너리 형식은 추 후에 사용하기 위해 예약되어 있습니다. 기본적으로 서버는 Origin 헤더에 값이 있는 연결을 허용합니다.</p></div></div><div id=outline-container-headline-7 class=outline-4><h4 id=headline-7>Long Polling</h4><div id=outline-text-headline-7 class=outline-text-4><p>롱 폴링은 <code>HTTP POST</code> 또는 <code>GET</code> 메소드로 연결됩니다(POST를 권장). 클라이언트의 첫 번째 요청에 대한 응답으로 서버는 <code>params</code> 에 <code>sid~(세션 ID) 값을 포함하는 ~{ctrl}</code> 메세지를 전송합니다. 롱 폴링 클라이언트는 첫 번째 이후 모든 요청에 URL 또는 request body에 <code>sid</code> 를 포함하여야 합니다.</p><p>서버는 모든 origin에 대하여 연결을 허용합니다. 예: <code>Access-Control-Allow-Origin: *</code></p></div></div><div id=outline-container-headline-8 class=outline-4><h4 id=headline-8>Out of Band Large Files</h4><div id=outline-text-headline-8 class=outline-text-4><p>대용량 파일은 <code>HTTP POST</code>, <code>Content-Type: multipart/form-data</code> 를 사용하여 전송됩니다. 자세한 내용은 <a href="#Out-of-Band Handling of Large Files">여기</a>를 참고하세요.</p></div></div><div id=outline-container-headline-9 class=outline-4><h4 id=headline-9>Running Behind a Reverse Proxy</h4><div id=outline-text-headline-9 class=outline-text-4><p>Tinode 서버는 NGINX와 같은 리버스 프록시 환경에서도 실행되도록 설정할 수 있습니다. 효율성을 위해 unix 소켓 파일 경로를 설정하여 unix 소켓을 통해 일반 연결, 또는 grpc 연결 등을 허용할 수 있습니다. 예:~unix:/run/tinode.sock~. <code>use_x_forwarded_for</code> 설정 파라메터를 <code>true</code> 로 설정하여 <code>X-Forwarded-For</code> HTTP 헤더에서 클라이언트의 IP 주소를 읽도록 서버를 구성 할 수도 있습니다.</p></div></div></div></div></div></div><div id=outline-container-headline-10 class=outline-2><h2 id=headline-10>Users</h2><div id=outline-text-headline-10 class=outline-text-2><p>사용자(User)는 실제 사람, 즉 메세지를 만들고 사용하는 사람을 의미합니다.</p><p>사용자에겐 일반적으로 두 가지 인증 레벨이 있는데, 인증(<code>auth</code>), 익명(<code>anon</code>)이 있습니다. 이 외의도 <code>root</code> 레벨이 있는데 이 레벨은 <code>gRPC</code> 를 통해서면 접근할 수 있고 <code>root</code> 사용자는 다른 사용자 대신 메세지를 보낼 수 있습니다.</p><p>처음 연결될 때 클라이언트 애플리케이션은 <code>{acc}</code> 또는 <code>{login}</code> 메세지를 보내 사용자를 인증할 수 있습니다.</p><p>사용자는 저마다 고유의 ID값을 가지고 있습니다. 이 ID값은 <code>user</code> 로 시작하는 base64-encoded 64-bit numeric 값입니다(예: <code>usr2il9suCbuko</code>). 사용자는 또한 아래의 속성들을 지닙니다.</p><ul><li><code>created</code>: 사용자 레코드가 생성된 시간(timestamp)</li><li><code>updated</code>: 사용자의 <code>public</code> 값이 갱신된 시간(timestamp)</li><li><code>status</code>: 사용자 계정의 상태</li><li><code>username</code>: <code>base</code> 인증(ID/PW login)에 사용되는 고유한 값입니다. username은 다른 사용자가 볼 수 없습니다.</li><li><code>defacs</code>: 인증 사용자나 익명 사용자와 P2P 대화를 위한 사용자의 기본 액세스 모드를 설명하는 개체입니다. 자세한 내용은 <a href="#Access Control">Access control</a>을 참고하세요.</li></ul><ul><li><code>auth</code>: <code>auth</code> 사용자를 위한 기본 액세스 모드</li><li><p><code>anon</code>: <code>anon</code> 사용자를 위한 기본 액세스 모드</p><ul><li><code>public</code>: 애플리케이션에서 정의한 사용자에 대한 정보가 담긴 오브젝트. 누구든지 쿼리문을 이용해 <code>public</code> 데이터를 조회할 수 있습니다.</li><li><code>private</code>: 애플리케이션에서 정의한 사용자에 대한 고유한 정보가 담긴 오브젝트. 오직 자기 자신만 조회할 수 있습니다.</li><li><code>tags</code>: <a href=#fnd>discovery</a> and credentials.</li></ul><p>사용자 계정은 상태값을 가집니다. 상태값 종류는 다음과 같습니다.</p><ul><li><code>ok</code> (normal): 기본 상태, 계정에 아무런 제약이 없고 정상적인 상태임을 의미합니다.</li><li><code>susp</code> (suspended): 사용자를 <a href=#fnd>검색</a>을 통해서도 찾을 수 없을뿐만 아니라 계정에 접근 자체를 할 수 없는 상태를 의미합니다. 관리자가 상태를 복구할 수 있습니다.</li><li><code>del</code> (soft-deleted): 사용자가 삭제 처리되었지만 데이터는 존재하는 상태를 의미합니다. 사용자 삭제는 현재 지원하지 않습니다.</li><li><code>undef</code> (undefined): 관리자가 내부적으로 사용합니다. 다른 곳에서 사용해서는 안됩니다.</li></ul><p>사용자는 서버에 동시에 여러 개의 연결(세션)을 유지할 수 있습니다. 각 세션에는 클라이언트에서 제공하는 <code>User-Agent</code> 태그가 달리며 이 태그값은 클라이언트 소프트웨어별로 다릅니다.</p><p>로그아웃은 애초에 설계단계부터 지원하지 않았습니다. 만약 애플리케이션에서 사용자를 전환해야 한다면, 새 사용자 인증을 이용해 연결을 새로 하기만 하면 됩니다.</p></li></ul><div id=outline-container-Authentication class=outline-3><h3 id=Authentication>Authentication</h3><div id=outline-text-Authentication class=outline-text-3><p>인증(Authentication)은 <a href=https://en.wikipedia.org/wiki/Simple_Authentication_and_Security_Layer>SASL</a>과 컨셉이 매우 유사합니다. 각각 다른 인증 방법을 구현할 수 있도록 어댑터를 제공하고 있습니다. 인증 구현체(Authenticators)는 <a href=#acc><code>{acc}</code></a> 를 이용해 사용자를 등록하거나 <a href=#login><code>{login}</code></a> 을 할 때 사용됩니다. 서버는 다음과 같은 인증 방법을 제공합니다.</p><ul><li><code>token</code> 방식은 암호화된 토큰을 이용해 인증합니다.</li><li><code>basic</code> 방식은 login-password 인증합니다.</li><li><code>anonymous</code> 방식은 채팅을 통한 고객 지원 요청 처리와 같은 임시 사용자를 위해 디자인 되었습니다.</li><li><code>rest</code> 방식은 JSON RPC를 통해 외부 인증 시스템을 사용할 수 있도록 하는 <a href=https://github.com/tinode/chat/tree/master/server/auth/rest>meta-method</a>입니다.</li></ul><p>이 외에 다른 인증 방식도 어댑터를 직접 구현하여 사용할 수 있습니다.</p><p><code>token</code> 은 기본 인증 방식으로 사용합니다. 이 토큰들은 토큰 인증에 가볍게 사용할 수 있도록 설계되었습니다. 예를 들어, 토큰 인증모듈(authenticator)는 일반적으로 데이터베이스에 접근하지 않고 모든 작업을 메모리 안에서 처리합니다. 다른 모든 인증 방법은 토큰을 얻거나 갱신하는데만 사용합니다. 일단 토큰이 확보되면 이 후 로그인 작업에서 이를 사용합니다.</p><p><code>basic</code> 인증 모듈은 username:password 형식의 문자열을 base64-encoded을 이용해 암호화 된 문자열을 사용합니다. 이때 username은 콜론문자(:)를 포함하지 않아야 합니다(ASCII 0X3A).</p><p><code>anonymous</code> 계정을 만들 때 사용할 수 있으며, 로그인에는 사용할 수 없습니다. 사용자는 <code>anonymous</code> 인증 체계를 사용하여 계정을 만들고 해당 계정에 로그인 할 수 있는 암호화 된 토큰을 얻습니다. 이 토큰을 잃어버리거나 만료되면 사용자는 더이상 해당 계정에 액세스 할 수 없습니다.</p><p>컴파일 된 인증 모듈은 설정 파일의 <code>logical_names</code> 값을 수정하여 변경할 수 있습니다. 예를 들어, 별도 제작된 <code>rest</code> 인증 모듈을 <code>basic</code> 인증 모듈을 대신해서 사용하거나 <code>token</code> 인증 모듈을 사용자로부터 숨길 수 있습니다. 이 기능은 설정 파일의 <code>logical_name:actual_name</code> 에서 actual_name 값을 바꾸거나 <code>actual_name:</code> 값을 숨겨서 활성화 할 수 있습니다. 예를 들어, 기본 인증에 <code>rest</code> 서비스를 사용하고 싶으면 <code>"logical_names":["basic:rest"]</code> 처럼 설정하면 됩니다.</p><div id=outline-container-headline-12 class=outline-4><h4 id=headline-12>Creating an Account</h4><div id=outline-text-headline-12 class=outline-text-4><p>새 계정을 만들 때, 사용자는 서버에 나중에 해당 계정에 접근할 인증 방법을 등록해야 합니다. 계정 생성은 <code>basic</code>, <code>anonymous</code> 인증만 사용할 수 있습니다. <code>basic</code> 인증은 고유 아이디 및 비밀번호를 서버에 등록해야 합니다. <code>anonymous</code> 는 인증 관련 내용을 등록하지 않습니다.</p><p>사용자가 <code>{acc login=true}</code> 를 셋팅했다면 즉시 인증을 위해 새 계정을 사용할 수 있습니다. <code>login=false</code> 일 경우엔(또는 설정되지 않았다면) 새 계정은 생성되지만 계정을 생성한 세션의 인증 상태는 변경되지 않습니다. <code>login=true</code> 일 경우 서버는 생성된 새 계정으로 세션 인증을 시도하고 {acc} 요청에 대한 성공 응답에는 인증 토큰이 포함됩니다. 이 룰은 익명 인증 시에 특히 중요합니다.</p></div></div><div id=outline-container-headline-13 class=outline-4><h4 id=headline-13>Logging in</h4><div id=outline-text-headline-13 class=outline-text-4><p>로그인은 <code>{login}</code> 요청을 통해서 실행됩니다. 로그인은 <code>basic</code>, <code>token</code> 인증을 통해서만 가능합니다. 모든 로그인은 200 코드와 <code>token</code> 인증에 사용할 토큰을 <code>{ctrl}</code> 메세지를 통해 응답 받거나, 300 코드와 추가 인증과 메소드 종속 문제, 또는 4xx 코드와 추가 정보를 요청합니다.<sup>(역자 주: 의역이에요.)</sup></p><p>토큰에는 서버 구성 만료 시간이 있으므로 주기적으로 갱신해야 합니다.</p></div></div><div id="outline-container-Changing Authentication Parameters" class=outline-4><h4 id="Changing Authentication Parameters">Changing Authentication Parameters</h4><div id="outline-text-Changing Authentication Parameters" class=outline-text-4><p>사용자가 아이디나 패스워드같은 인증 관련 파라메터를 변경하려면 <code>{acc}</code> 사용해서 요청을 해야한다. 현재는 <code>basic</code> 인증만 지원한다.</p><div class="src src-json"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=err>acc:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl> <span class=err>id:</span> <span class=nt>&#34;1a2b3&#34;</span><span class=p>,</span> <span class=c1>// string, client-provided message id, optional
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=err>user:</span> <span class=nt>&#34;usr2il9suCbuko&#34;</span><span class=p>,</span> <span class=c1>// user being affected by the change, optional
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=err>token:</span> <span class=nt>&#34;XMg...g1Gp8+BO0=&#34;</span><span class=p>,</span> <span class=c1>// authentication token if the session
</span></span></span><span class=line><span class=cl><span class=c1></span>                            <span class=c1>// is not yet authenticated, optional.
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=err>scheme:</span> <span class=nt>&#34;basic&#34;</span><span class=p>,</span> <span class=c1>// authentication scheme being updated.
</span></span></span><span class=line><span class=cl><span class=c1></span> <span class=err>secret:</span> <span class=err>base64encode(</span><span class=nt>&#34;new_username:new_password&#34;</span><span class=err>)</span> <span class=c1>// new parameters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span></span></span></code></pre></td></tr></table></div></div></div><p>패스워드만 바꾸고 싶다면, <code>username</code> 필드는 비워놓아야 한다(예: <code>secret: base64encode("new_password")</code>).</p><p>세션이 인증되지 않은 상태라면, request는 무조건 <code>token</code> 을 포함하고 있어야 한다. 이 <code>token</code> 은 로그인을 통해 얻은 일반 인증 토큰이거나, <a href="#resetting a password">비밀번호 재설정</a> 작업을 통해 얻는 토큰일 수 있습니다. 세션이 인증되면 <code>token</code> 을 포함하지 않아야 합니다. 만약 <code>ROOT</code> 레벨로 인증했다면 <code>user</code> 값에 다른 유효한 사용자의 ID값을 셋팅할 수 있습니다. 그렇지 않다면 이 값을 빈 값으로 유지하거나(기본값: 현재 사용자) 자기 자신의 ID값을 할당해야 합니다.</p></div></div><div id="outline-container-resetting a password" class=outline-4><h4 id="resetting a password">Resetting a Password, i.e. "Forgot Password"</h4><div id="outline-text-resetting a password" class=outline-text-4><p>아이디나 비밀번호를 초기화 할 때(또는 인증 모듈이 지원하는 인증용 시크릿 토큰), <code>{login}</code> 메세지를 <code>scheme</code>, <code>reset</code>, 그리고 base64-encoded 문자값("<code>authentication scheme to reset secret for</code>:~reset method~:~reset method value~")을 포함한 <code>secret</code> 값을 전송합니다. 가장 일반적인 케이스로 이메일의 비밀번호 수정을 하는 코드는 아래와 같습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>login: {
</span></span><span class=line><span class=cl> id: &#34;1a2b3&#34;,
</span></span><span class=line><span class=cl> scheme: &#34;reset&#34;,
</span></span><span class=line><span class=cl> secret: base64encode(&#34;basic✉️jdoe@example.com&#34;)
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>여기서 <code>jdoe@example.com</code> 은 이전에 검증된 사용자의 이메일입니다.</p><p>이메일이 등록된 데이터와 일치하면, 서버는 비밀번호를 재설정 하기 위한 지시 사항과 함께 지정된 방법 및 주소를 사용하여 메세지를 보냅니다. <a href="#Changing Authentication Parameters">Changing Authentication Parameters</a> 섹션에 설명된대로 이메일에는 <code>{acc}</code> request에 포함할 수 있는 시크릿 코드가 포함되어 있습니다.</p></div></div></div></div><div id=outline-container-headline-16 class=outline-3><h3 id=headline-16>Suspending a User</h3><div id=outline-text-headline-16 class=outline-text-3><p>사용자 계정은 관리자에 의해 정지될 수 있습니다. 계정이 정지되면 사용자는 더이상 로그인 할 수 없고 서비스도 이용할 수 없습니다.</p><p><code>root</code> 사용자만이 다른 계정을 정지시킬 수 있습니다. 관리자에 의해 계정이 정지된 사용자는 아래의 메세지를 받습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>acc: {
</span></span><span class=line><span class=cl>id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>user: &#34;usr2il9suCbuko&#34;, // user being affected by the change
</span></span><span class=line><span class=cl>status: &#34;suspended&#34;
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>정지가 해제된 계정은 위와 동일한 메세지를 수신하지만 <code>status: "ok"</code> 값이 담긴 메세지를 수신합니다. 관리자는 <code>{get what="desc"}</code> 커맨드를 실행하여 사용자의 <code>me</code> topic을 조회할 수 있습니다.</p></div></div><div id=outline-container-headline-17 class=outline-3><h3 id=headline-17>Credential Validation</h3><div id=outline-text-headline-17 class=outline-text-3><p>서버는 필요하다면 특정 인증 체계를 이용한 사용자 계정 인증 기능을 선택적으로 구성할 수 있습니다. 예를 들어, 사용자에게 고유한 이메일, 전화번호 등을 제공하도록 요구하거나 계정 등록 조건으로 보안 문자를 해결하도록 요구할 수 있습니다.</p><p>서버는 약간의 설정 변경만으로 이메일 인증을 지원할 수 있습니다. 대부분 잘 동작하며, 문자 메세지를 보내기 위해서는 별도 상용 서비스가 필요하기 때문에 전화번호 인증 기능은 제대로 동작하지 않습니다.</p><p>자격 증명이 활성화 된 상태일 경우, 사용자는 항상 유효성 검사에 통과된 상태여야 합니다. 필수 자격 증명을 변경해야 하는 경우엔 사용자가 먼저 새 자격 증명을 추가하고 유효성 검사를 한 다음 이전 자격 증명을 제거해야 합니다.</p><p>자격 증명은 <code>{acc}</code> 메세지를 보내 할당되고, <code>{set topic="me"}</code> 를 통해 추가되고, <code>del topic="me"</code> 를 통해서 삭제됩니다. 자격 증명은 <code>{login}</code> 또는 <code>{acc}</code> 메세지를 전송하여 클라이언트 측에서 확인됩니다.</p></div></div><div id="outline-container-Access Control" class=outline-3><h3 id="Access Control">Access Control</h3><div id="outline-text-Access Control" class=outline-text-3><p>Access Control은 Access Control 목록(ACLs) 또는 Bearer Token(bearer token은 0.15 버전부터는 구현되지 않음)을 통해 Topic에 대한 Access를 관리합니다.</p><p>Access Control은 대부분 group topic에 사용됩니다. <code>me</code>, P2P Topic에 대해서는 현재 상태 알림을 관리하고 1:1 대화를 시작하거나 대화를 중지하는 등 제한적인 용도로 사용됩니다.
사용자의 Topic에 대한 Access는 권한을 요청하는 "want", 그리고 Topic에 대한 매니저 권한을 부여하는 "given" 등 두 가지로 나뉩니다. 각 권한은 bitmap에 bit 단위로 표현됩니다. 이는 존재하거나 없을 수 있습니다. 실제 Access는 원하는 권한(want)와 부여된 권한(given)의 bit값을 AND 연산한 결과로 결정됩니다. 연산 결과(즉, 권한)는 ASCCII 문자열 형태로 메세지로 전달됩니다. 다음 목록의 문자열은 설정된 권한 bit를 의미합니다.</p><ul><li>No Access: <code>N</code>, 권한이 명시적으로 설정되지 않았음을 의미합니다. 일반적으로 기본 권한이 적용되지 않아야 함을 나타냅니다.</li><li>Join: <code>J</code>, Topic을 구독할 수 있는 권한을 나타냅니다.</li><li>Read: <code>R</code>, <code>{data}</code> 패킷을 수신할 수 있는 권한을 나타냅니다.</li><li>Write: <code>W</code>, <code>{pub}</code> 토픽에 대한 권한을 나타냅니다.</li><li>Presense: <code>P</code>, <code>{pres}</code> 메세지를 수신하여 현재 상태를 갱신할 수 있는 권한을 나타냅니다.</li><li>Approve: <code>A</code>, Topic 참여 요청을 승인할 수 있는 권한을 나타냅니다. 이 권한을 가진 사용자는 해당 Topic의 관리자입니다.</li><li>Sharing: <code>S</code>, 다른 사용자를 Topic에 초대할 수 있는 권한을 나타냅니다.</li><li>Delete: <code>D</code>, 메세지 영구 삭제 권한, 토픽의 소유자만 이 기능을 사용할 수 있습니다.</li><li>Owner: <code>O</code>, 토픽의 소요자를 의미합니다. Topic 당 최대 한명의 소유자만 존재할 수 있습니다. 일부 Topic은 소유자가 없을 수 있습니다.</li></ul><p>Topic의 기본 액세스는 Topic 생성 시 <code>{sub, desc, defacs}</code> 에 의해 설정되며, 이후에 <code>{set}</code> 메세지를 이용해 수정할 수 있습니다. 기본 액세스는 인증 사용자와 익명 사용자 두 범주에 대해 정의됩니다. 이 값은 모든 새 참석자(subscription)에 대해 "given" 권한이 적용됩니다.</p><p>클라이언트는 <code>{sub}</code>, <code>{set}</code> 메세지의 권한을 빈 문자열로 대체하여 Tinode 기본 권한으로 초기화 할 수 있습니다. 클라이언트가 Topic을 생성할 때 기본 액세스 권한을 설정하지 않으면 인증된 사용자는 <code>RWP</code> 권한을 부여받게 되고 익명 사용자는 빈 권한을 부여받아 관리자에게 별도로 승인을 받아야만 Topic에 참여할 수 있습니다.</p><p>액세스 권한은 <code>{set}</code> 메세지를 사용해 사용자별로 할당할 수 있습니다.</p></div></div></div></div><div id=outline-container-headline-19 class=outline-2><h2 id=headline-19>Topics</h2><div id=outline-text-headline-19 class=outline-text-2><p>Topic은 한명 또는 여러명이서 커뮤니케이션을 하는 채널을 의미합니다. 모든 토픽은 persistent property를 가지고 있습니다. 이러한 토픽의 property는 <code>{get what="desc"}</code> 메세지를 이용해서 쿼리를 요청할 수 있습니다.</p><p>아래의 Topic property 목록은 쿼리를 호출하는 사용자가 누구든 독립적으로 존재합니다.</p><ul><li><code>created</code>: Topic이 생성된 시간(timestap)</li><li><code>updated</code>: Topic의 <code>public</code> 또는 <code>private</code> 속성이 마지막으로 수정된 시간(timestamp)</li><li><code>touched</code>: Topic에 마지막으로 메세지가 전송된 시간(timestamp)</li><li><code>defacs</code>: 인증 사용자와 익명 사용자를 위한 액세스 모드를 나타내는 속성. 자세한 내용은 <a href="#Access Control">Access Control</a>을 참고하세요</li><li><code>auth</code>: 인증 사용자를 위한 액세스 모드를 나타내는 속성</li><li><code>anon</code>: 익명 사용자를 위한 액세스 모드를 나타내는 속성</li><li><code>seq</code>: Topic에 전송된 최신 <code>{data}</code> 메세지의 고유 아이디. 서버측에서 생성한 integer 값.</li><li><code>public</code>: Topic을 설명하는 어플리케이션 정의 객체. Topic을 구독할 수 있는 사람은 누구나 Topic의 public data를 조회할 수 있습니다.</li></ul><p>사용자 종속 Topic 속성 목록</p><ul><li><code>acs</code>: 현재 사용자의 해당 Topic에 대한 액세스 권한을 나타내는 속성. 자세한 내용은 <a href="#Access Control">Access Control</a>을 참고하세요.</li><li><code>want</code>: 현재 사용자가 요청한 접근 권한</li><li><code>given</code>: 현재 사용자의 접근 권한</li><li><code>private</code>: 현재 사용자 고유의 어플리케이션 정의 객체.</li></ul><p>Topic은 보통 구독자가 있습니다. 구독자 중 한명은 전체 액세스 권한이 있는 Topic 소유자로 지정될 수 있습니다(<code>O</code> 액세스 권한). 구독자 목록은 <code>{get what="sub"}</code> 메세지를 이용해서 조회할 수 있습니다. 구독자 목록은 <code>{meta}</code> 메세지의 <code>sub</code> 섹션 형태로 반환됩니다.</p><div id=outline-container-headline-20 class=outline-3><h3 id=headline-20><code>me</code> Topic</h3><div id=outline-text-headline-20 class=outline-text-3><p><code>me</code> Topic은 모든 사용자가 각자 계정을 생성할 때 자동으로 생성됩니다. 이 Topic은 계정 정보를 관ㄹ리하고 관심있는 사람과 Topic으로부터 알림을 받는 용도로 사용됩니다. <code>me</code> Topic은 소유자가 없습니다. 이 Topic은 삭제하거나 구독 취소를 할 수 없습니다. 모든 관련 커뮤니케이션을 중단하고 사용자가 오프라인 상태임을 나타낼 수 있습니다(하지만 사용자는 여전히 로그인 되어있고 다른 Topic을 사용할 수 있습니다.).</p><p><code>me</code> Topic에 보낸 <code>{get what = "desc"}</code> 메세지는 <code>{meta}</code> 메세지가 포함된 <code>desc</code> 섹션이 topic 파라메터와 함께 자동으로 반환됩니다(<a href=#Topic>Topic</a> 섹션을 참고하세요). <code>me</code> topic의 <code>public</code> 파라메터는 사용자 연결에 표시하려는 데이터입니다. <code>public</code> 파라메터를 변경하면 <code>me</code> Topic뿐만 아니라 사용자의 <code>public</code> 정보가 표시된 모든 곳이 변경됩니다.</p><p>다른 Topic에 <code>{get what="sub"}</code> 메세지를 보내면 해당 토픽의 구독자 목록을 반환하는것과 달리 <code>me</code> Topic에 보내는 <code>{get what="sub"}</code> 메세지는 현재 사용자가 구독한 Topic 목록을 반환합니다.</p><ul><li>seq: 서버측에서 발급한 topic의 마지막 message 고유 ID값</li><li>recv: 현재 사용자가 수신받은 메세지에 대해 직접 설정한 seq 값</li><li>read: 현재 사용자가 읽은 메세지에 대해 직접 설정한 seq 값</li><li>seen: P2P Topic 구독의 경우, 사용자의 마지막 온라인 시간(timestamp) 및 User Agent 값</li><li>when: 사용자의 마지막 온라인 시간</li><li>ua: 사용자가 마지막으로 사용한 클라이언트 소프트웨어에 대한 user agent 값</li></ul><p><code>me</code> Topic에 보내는 <code>{get what="data"}</code> 메세지는 거부됩니다.</p></div></div><div id=outline-container-fnd class=outline-3><h3 id=fnd><code>fnd</code> and Tags: Finding Users and Topics</h3><div id=outline-text-fnd class=outline-text-3><p><code>fnd</code> Topic은 모든 사용자가 각자 계정을 생성할 때 자동으로 생성됩니다. 이 Topic은 다른 사용자나 group Topic을 검색할 때 사용됩니다. 사용자와 group topic은 <code>tags</code> 키워드를 기준으로 검색합니다. 태그는 Topic 또는 사용자 생성 시 지정할 수 있으며, 이 후에는 <code>{set what="tags"}</code> 를 사용하여 <code>me</code> 또는 group Topic의 tags를 수정할 수 있습니다.</p><p>태그는 대소문자를 구분하지 않는 유니코드 문자열(서버에서 강제로 소문자로 적용)이며, 문자 및 숫자 유니코드 <a href=https://en.wikipedia.org/wiki/Unicode_character_property#General_Category>클래스/카테고리</a> 문자뿐만 아니라 ASCII 문자(<code>_</code>, <code>.</code>, <code>+</code>, <code>-</code>, <code>@</code>, <code>#</code>, <code>!</code>, <code>?</code>)를 포함할 수 있습니다.</p><p>태그는 네임 스페이스 역할을 하는 접두사가 있을 수 있습니다. 이 접두사는 2-16개 사이의 string 문자열이며 [a-z] 로 시작하며, 소문자 ASCII 문자 및 숫자와 콜론을 포함할 수 있는데(<code>:</code>), 예를 들어 휴대전화 태그는 <code>tel:+14155551212</code> 처럼 나타내며 이메일 주소는 <code>email:alice@example.com</code> 처럼 나타냅니다. 일부 접두사 태그는 선택적으로 고유도록 적용됩니다(unique). 이 경우 한명의 사용자 또는 Topic만 이러한 태그를 가질 수 있습니다. 특정 태그는 사용자가 변경할 수 없도록 강제할 수 있습니다. 즉, 사용자가 변경 불가능한 태그를 추가하거나 제거하려는 시도는 서버에서 거부됩니다.</p><p>태그는 서버측에서 인덱싱되며 사용자 및 Topic 검색에 사용됩니다. 검색은 일치하는 태그 수를 기준으로 내림차순으로 정렬됩니다.</p><p>사용자 또는 Topic을 찾기 위해 사용하는 <code>fnd</code> Topic의 <code>public</code> 또는 <code>private</code> 파라메터 변수를 검색 쿼리(<a href="#Query Language">Query language</a> 참고)로 설정하고 <code>{get topic="fnd" what="sub"}</code> 메세지를 보냅니다. 만약 <code>public</code>, <code>private</code> 둘 다 설정했다면, <code>public</code> 값이 사용됩니다. <code>private</code> 쿼리는 세션과 디바이스 기기에서 유지됩니다, 예를 들어 모든 유저 세션은 같은 <code>private</code> 쿼리를 조회하게 됩니다. <code>public</code> 쿼리의 장점은 휘발성, 즉, 데이터베이스에 저장되거나 사용자 세션끼리 공유되지 않습니다. <code>private</code> 쿼리는 휴대 전화의 사용자 접속 목록에 있는 모든 사람의 일치 항목을 찾는 것과 같은 자주 변경되지 않는 대규모 작업 쿼리를 위한 것입니다. <code>public</code> 쿼리는 특정 Topic 또는 내 휴대전화 목록에 없는 사용자를 찾는 것과 같과 같이 간단한 쿼리 작업에 주로 쓰입니다.</p><p>시스템은 발견된 사용자 또는 Topic의 세부정보를 구독 형식으로 <code>subsection</code> section에 담아 <code>{meta}</code> message 형태로 반환합니다.</p><p><code>fnd</code> Topic은 읽기 전용으로, <code>fnd</code> Topic에 <code>{pub}</code> 메세지를 보낼 경우 거절당합니다.</p><p><em>현재 지원하지 않음</em> 새 사용자가 지정된 쿼리와 일치하는 태그를 등록하면 <code>fnd</code> Topic이 새 사용자 등록을 알리는 <code>{pres}</code> 메세지를 반환합니다.</p><p><a href=https://github.com/tinode/chat/tree/master/pbx>Plugins</a>을 이용해 커스텀 검색 기능을 제공할 수 있습니다.</p><div id="outline-container-Query Language" class=outline-4><h4 id="Query Language">Query Language</h4><div id="outline-text-Query Language" class=outline-text-4><p>Tinode query language는 사용자와 Topic을 검색하기 위한 언어입니다. 쿼리는 공백 또는 쉼표로 구분된 문자열입니다. 각 검색어는 사용가 또는 Topic의 태그들과 일치합니다. 각 검색어는 RTL 방식으로 쓰여졌을 수 있지미만 쿼리는 항상 왼쪽에서 오른쪽 방향으로 파싱됩니다. 공백은 <code>AND</code> 연산으로 처리되며, 쉼표(앞뒤에 공백이 있는 쉼표 포함)는 <code>OR</code> 연산으로 처리됩니다. 연산자의 순서는 무시됩니다. <code>A~ND 연산자는 AND 연산자끼리, ~OR</code> 연산자는 OR 연산자끼리 그룹화됩니다. <code>OR</code> 연산이 <code>AND</code> 보다 우선순위가 높습니다. 태그 앞에 쉼표가 오면 <code>OR</code> 태그, 그렇지 않으면 <code>AND</code> 로 취급됩니다. 예를 들어, <code>aaa bbb, ccc</code> (<code>aaa AND bbb OR ccc</code>)는 <code>(bbb or CCC) AND aaa</code> 로 해석됩니다.</p><p>공백이 포함된 검색어는 공백을 언더바(_)로 치환해서 검색해야 합니다 <code>‎</code> -> <code>_</code> (예: <code>new york</code> -> <code>new_york</code>).</p><div id=outline-container-headline-23 class=outline-5><h5 id=headline-23>Some examples:</h5><div id=outline-text-headline-23 class=outline-text-5><ul><li><code>flowers</code>: <code>flowers</code> 태그가 있는 사용자 또는 Topic을 검색합니다.</li><li><code>flowers travel</code>: <code>flowers</code>, <code>travel</code> 두 태그를 모두 포함한 사용자 또는 Topic을 검색합니다.</li><li><code>flowers, travel</code>: <code>flowers</code> 또는 <code>travel</code> 둘 중 하나의 태그라도 포함한 사용자 또는 Topic을 검색합니다(또는 둘 다 포함한).</li><li><code>flowers travel, puppies</code>: <code>flowers</code> 를 포함하고 <code>travel</code> 또는 <code>puppies</code> 를 포함한 사용자 또는 Topic을 검색합니다(<code>(travel OR puppies) AND flowers</code>).</li><li><code>flowers, travel puppies, kitten</code>: <code>flowers</code>, <code>travel</code>, <code>puppies</code>, <code>kittens</code> 중 하나라도 포함한 사용자 또는 Topic을 검색합니다. <code>travel</code> 과 <code>puppies</code> 사이에 있는 공백은 <code>OR</code> 연산이 <code>AND</code> 연산보다 우선하므로 <code>OR</code> 로 치환됩니다.</li></ul></div></div></div></div><div id=outline-container-headline-24 class=outline-4><h4 id=headline-24>Incremental Updates to Queries</h4><div id=outline-text-headline-24 class=outline-text-4><p><em>현재 지원하지 않는</em> 쿼리입니다. 특히 <code>fnd.private</code> 는 메세지 크기 제한과 기본 데이버테이스 쿼리 크기 제한에 의해서만 제한될 수 있습니다. 전체 쿼리를 다시 작성하여 검색어를 추가하거나 제거하는 대신, 검색어를 점진적으로 추가하거나 제거할 수 있습니다.</p><p>incremental update 요청은 왼쪽에서 오른쪽으로 처리됩니다. 또한 동일한 검색어를 여러 번 포함할 수 있습니다. 즉, <code>-a_tag+a_tag</code> 는 유효한 요청입니다.</p></div></div><div id=outline-container-headline-25 class=outline-4><h4 id=headline-25>Query Rewrite</h4><div id=outline-text-headline-25 class=outline-text-4><p>login, 전화번호 또는 이메일로 사용자를 찾으려면 <code>alice@example.com</code> 대신 <code>email:alice@example.com</code> 같이 접두사를 사용하여 검색어를 작성해야 합니다. 이러한 방법은 사용자가 직접 쿼리를 배워야 하기 때문에 문제가 될 수 있습니다. tinode는 이 문제를 서버에서 <em>쿼리를 재작성</em> 하는 방식으로 문제를 해결했습니다. 만약 검색어가 접두사가 없을 경우, 서버가 적절한 접두사를 붙여 쿼리를 재작성 합니다. <code>fnd.public</code> 에 대한 쿼리에서 원래 용어도 유지되고(쿼리문 <code>alice@example.com</code> 은 <code>email:alice@example.com OR alice@example</code> 로 재작성 됩니다.) <code>fnd.private</code> 에 대한 쿼리에서는 다시 작성된 검색어만 유지됩니다(<code>alice@example.com</code> 쿼리는 <code>email:alice@example.com</code> 으로 재작성 됩니다.). <code>alice@example</code> 처럼 이메일처럼 보이는 모든 검색어는 <code>email:alice@example.com OR alice@example.com</code> 처럼 재작성 됩니다. 전화번호처럼 보이는 용어는 <a href=https://en.wikipedia.org/wiki/E.164>E.164</a> 형식으로 변환되고 <code>tel:+14155551212 OR +14155551212</code> 형식으로 재작성됩니다. 그리고 <code>fnd.public</code> 에 대한 쿼리에서 로그인처럼 보이는 접두사가 없는 모든 용어는 <code>alice</code> -> <code>basic:alice OR alice</code> 형식으로 재작성 됩니다.</p><p>위에서 설명한대로 전화번호처럼 보이는 태그는 E.164 형식으로 변환됩니다. 이러한 변환에는 ISO3166-1 alpha-2 국가코드가 필요합니다. 전화번호 태그를 E.164 형식으로 변환하는 로직은 아래와 같습니다.</p><ul><li>태그에 이미 국가 전화코드가 포함되어 있으면 그대로 사용합니다. <code>+1(415)555-1212</code> -> <code>+14155551212</code>.</li><li>만약 태그에 접두사가 없다면, <code>{hi}</code> 메세지를 통해 설정된 클라이언트의 <code>lang</code> 필드를 참고하여 국가코드를 설정합니다.</li><li>만약 클라이언트 <code>hi.lang</code> 값을 통해 국가코드를 추출하지 못했다면, <code>tinode.conf</code> 파일에 설정된 <code>default_country_code</code> 필드값을 이용해 국가코드를 설정합니다.</li><li><code>tinode.conf</code> 파일의 <code>default_country_code</code> 값이 없을 경우, <code>us</code> 국가코드를 기본값으로 사용합니다.</li></ul></div></div><div id=outline-container-headline-26 class=outline-4><h4 id=headline-26>Possible Use Cases</h4><div id=outline-text-headline-26 class=outline-text-4><ul><li>사용자를 조직으로 제한합니다. 변하지 않는 태그를 사용자에게 할당에 사용자가 어느 조직에 소속되어 있는지 표시할 수 있습니다. 사용자가 다른 사용자 또는 Topic을 검색할 때, 검색에 항상 태그를 포함해야 하도록 제한할 수 있습니다. 이 방식은 서로 다른 조직이 서로 검색되지 않도록 사용자를 세분화 하는 데 사용할 수 있습니다.</li><li>위치 정보를 기반으로 검색할 수 있습니다. 클라이언트가 주기적으로 사용자의 위치를 기반으로 생성한 <a href=https://en.wikipedia.org/wiki/Geohash>geohash</a> 태그를 등록할 수 있습니다. 특정 지역에서 사용자를 검색하면 geosh 태그가 해당 위치에 속한 사용자를 검색할 수 있습니다.</li><li>Search by numerical range, such as age range. The approach is similar to geohashing. The entire range of numbers is covered by the smallest possible power of 2, for instance the range of human ages is covered by 27=128 years. The entire range is split in two halves: the range 0-63 is denoted by 0, 64-127 by 1. The operation is repeated with each subrange, i.e. 0-31 is 00, 32-63 is 01, 0-15 is 000, 32-47 is 010. Once completed, the age 30 will belong to the following ranges: 0 (0-63), 00 (0-31), 001 (16-31), 0011 (24-31), 00111 (28-31), 001111 (30-31), 0011110 (30). A 30 y.o. user is assigned a few tags to indicate the age, i.e. <code>age:00111</code>, <code>age:001111</code>, and <code>age:0011110</code>. Technically, all 7 tags may be assigned but usually it's impractical. To query for anyone in the age range 28-35 convert the range into a minimal number of tags: <code>age:00111</code> (28-31), <code>age:01000</code> (32-35). This query will match the 30 y.o. user by tag <code>age:00111</code>.</li></ul></div></div></div></div><div id=outline-container-headline-27 class=outline-3><h3 id=headline-27>Peer to Peer Topics</h3><div id=outline-text-headline-27 class=outline-text-3><p>Peer to Peer(P2P) Topic은 오직 단 두 사용자의 소통을 위한 채널입니다. 같은 하나의 Topic이라도 Topic의 이름은 각 사용자마다 다릅니다. 각 사용자들은 상대방의 ID(<code>usr</code> 뒤에 붙는 사용자의 base64 URL-encoded ID)를 Topic의 이름으로 인식합니다. 예를 들어, 사용자 <code>usrOj0B3-gSBSs</code>, <code>usrIU_LOVwRNsc</code> 둘이서 P2P Topic을 시작했다면, <code>usrOj0B3-gSBSs</code> 사용자는 Topic의 이름을 <code>usrIU_LOVwRNsc</code> 로 인식합니다. 반대로 <code>usrIU_LOVwRNsc</code> 사용자는 Topic의 이름을 <code>usrOj0B3-gSBSs</code> 로 인식합니다.</p><p>P2P Topic은 사용자가 다른 사용자의 ID를 이름의 topic을 구독하면 생성됩니다. 만약 <code>usrOj0B3-gSBSs</code> 사용자가 <code>{sub topic="usrIU_LOVwRNsc"}</code> 메세지를 보낸다면 <code>usrIU_LOVwRNsc</code> 사용자를 대상으로 P2P Topic을 생성할 수 있습니다. Tinode는 위에서 설명한대로 <code>{ctrl}</code> 패킷과 함께 새로 생성된 Topic의 이름을 반환합니다. 상대 사용자는 액세스 권한이 있는 <code>me</code> topic을 통해 <code>{pres}</code> 메세지를 수신합니다.</p><p>P2P topic의 'public' 파라메터는 사용자에 따라 다릅니다. 예를 들어 사용자 A와 B 사이의 P2P topic은 사용자 A의 'public' 정보를 B에게 표시하고 반대의 경우도 마찬가지입니다. 사용자가 'public' 정보를 수정하면, 모든 사용자의 P2P topic에 자동으로 'public' 정보가 변경됩니다.</p><p>P2P topic의 'private' 파라메터는 다른 topic 타입과 마찬가지로 각 사용자가 각각 개별적으로 정의합니다.</p></div></div><div id=outline-container-headline-28 class=outline-3><h3 id=headline-28>Group Topics</h3><div id=outline-text-headline-28 class=outline-text-3><p>Group Topic은 여러 사용자끼리 통신할 수 있는 채널을 의미합니다. group topic의 이름은 <code>grp</code> 또는 <code>chn</code> 으로 시작하는 base64 URL-encoded 문자열로 구성되어 있습니다. 그룹 이름의 내부 구조나 길이는 무조건 이 형식의 갖추어야 합니다.</p><p>Group Topic은 각 참가자별 접근 권한을 통해 참가자 수를 제한할 수 있습니다(설정 파일의 <code>max_subscriber_count</code> 값에 의해 제어). Group topic은 또한 읽기 전용 사용자 수(<code>readers</code>)를 설정할 수 있습니다. 모든 <code>reader</code> 들은 동일한 접근 권한을 가집니다. <code>reader</code> 가 활성화 된 group topic을 <code>channels</code> 라고 합니다.</p><p>Group Topic은 topic 필드에 <code>new</code> 또는 <code>nch</code> 로 시작하는(예: <code>new</code>, <code>newAbC123</code>) 텍스트를 포함한 <code>{sub}</code> 메세지를 전송하여 생성할 수 있습니다. Tinode 서버는 새로 생성된 topic의 이름이 포함된 <code>{ctrl}</code> 메세지를 반환할 것입니다. 예를 들어, <code>{sub topic="new"}</code> 메세지를 전송하면 <code>{ctrl topic="grpmiKBkQVXnm3P"}</code> 메세지가 반환됩니다. 만약 topic 생성에 실패하면 원본 topic 이름(예: <code>new</code>, <code>newAbC123</code>)에 오류가 보고됩니다. topic을 생성한 사용자가 해당 topic의 소유자가 됩니다. <code>{set}</code> message를 통해 소유권을 다른 사용자에게 양도할 수 있지만 한명의 사용자는 항상 소유자로 남아 있어야합니다.</p><p><code>channel</code> topic은 다른 non-channel group topic 비교해서 아래와 같은 차이가 있습니다.</p><ul><li>Channel topic은 <code>{sub topic="nch"}</code> 메세지를 전송해서 생성합니다. <code>{sub topic="new"}</code> 메세지는 channel이 활성화 되지 않은 group topic을 생성합니다.</li><li><code>{sub topic="chnAbC123"}</code> 메세지를 보내면 해당 채널에 대한 <code>reader</code>, 구독이 생성됩니다. 이 메세지를 non-channel에 보내면 거절당합니다.</li><li><a href=#fnd>fnd</a>를 이용해 topic을 찾을 때, channel 주소는 <code>chn</code> 글자로 시작합니다.. non-channel topic은 <code>grp</code> 글자로 시작합니다.</li><li>channel topic 구독자가 받는 메세지는 <code>From</code> 필드가 없습니다. 일반 group topic 사용자가 받는 메세지에는 발신자가 표시된 <code>From</code> 필드가 포함되어 있습니다.</li><li>channel과 non-channel group topic의 기본 권한에는 차이가 있습니다. channel topic group에는 어떤 권한도 부여되지 않습니다.</li><li>일반 또는 channel이 활성화 된 Topic에 새 사용자가 참여 또는 탈퇴할 경우 다른 적합한 권한이 있는 모든 topic 참여자들에게 <code>{pres}</code> 메세지를 전송합니다. reader가 참여하거나 탈퇴할 경우엔 <code>{pres}</code> 메세지를 생성하지 않습니다.</li></ul></div></div><div id=outline-container-headline-29 class=outline-3><h3 id=headline-29><code>sys</code> Topic</h3><div id=outline-text-headline-29 class=outline-text-3><p><code>sys</code> topic은 시스템 관리자와 항상 사용 가능한 통신 채널입니다. 루트가 아닌 일반 사용자는 <code>sys</code> topic을 구독할 수 없지만 메세지를 보낼 순 있습니다. 기존 클라이언트는 이 채널을 사용하여 JSON 형식의 보고서를 <code>{pub}</code> 메세지를 사용하여 악용 사례를 신고합니다. 루트 사용자는 <code>sys</code> topic을 구독할 수 있습니다. 일단 구독하면, 루트 사용자는 다른 사용자가 <code>sys</code> topic에 보낸 메세지를 받게됩니다.</p></div></div></div></div><div id=outline-container-headline-30 class=outline-2><h2 id=headline-30>Using Server-Issued Message IDs</h2><div id=outline-text-headline-30 class=outline-text-2><p>Tinode는 서버측에서 생성한 메세지 ID를 <code>{data}</code> 메세지 형태로 클라이언트 사이드에서 캐싱하는 기능을 기본적으로 지원합니다. 클라이언트는 <code>{get what="desc"}</code> 메세지를 전송하여 topic의 마지막 메세지 ID를 요청할 수 있습니다. 만약 반환된 ID값이 마지막으로 수신한 메세지의 ID값보다 크다면 클라이언트는 해당 topic에서 읽지 않은 메세지가 있음을, 그리고 그 갯수를 파악할 수 있습니다. 클라이언트는 <code>{get what="data"}</code> 메세지를 사용하여 이러한 메세지들을 가져올 수 있습니다. 클라이언트는 메세지 ID를 사용하여 메세지 목록 페이징 처리를 할 수 있습니다.</p></div></div><div id=outline-container-headline-31 class=outline-2><h2 id=headline-31>User Agent and Presence Notifications</h2><div id=outline-text-headline-31 class=outline-text-2><p>하나 이상의 사용자 세션이 <code>me</code> topic에 연결되면 사용자가 온라인 상태인 것으로 간주합니다. 클라이언트 소프트웨어는 <code>{lgoin}</code> 메세지를 전송할 때 <code>ua</code> (user agent) 필드값을 설정하여 서버에 자신을 식별시킬 수 있습니다. user agent는 아래와 같은 방식으로 <code>{meta}</code> 및 <code>{pres}</code> 메세지를 게시합니다.</p><ul><li>사용자의 첫번째 세션이 <code>me</code> 에 연결될 때, 해당 세션의 <em>user agent</em> 가 <code>{pres what="on" ua="..."}</code> 메세지로 형태로 전송됩니다.</li><li>여러 사용자가 <code>me</code> topic에 연결될 때, <em>user agent</em> 는 가장 최근에 동작이 발생한 세션의 <code>{pres what="ua" ua="..."}</code> 메세지를 기준으로 합니다. 이때 '동작'이란 클라이언트에서 가장 최근에 메세지를 발송함을 의미합니다. 잠재적으로 과도한 트래픽을 방지하기 위해 user agent 변경 사항은 최대 1분에 한번만 설정됩니다.</li><li>사용자의 마지막 세션이 <code>me</code> topic에서 연결이 끊어질 때, <em>user agent</em> 는 해당 세션의 user agent를 타임스탬프와 함께 기록합니다. 이 때 user agent는 <code>{pres what="off" ua="..."}</code> 메세지에 의해 설정되고 이 때 타임스탬프도 함께 기록됩니다.</li></ul><p>빈 <code>ua=""</code> <em>user agent</em> 값은 허용되지 않습니다. 즉, 사용자가 비어있지 않은 <em>user agent</em> 값을 가지고 <code>me</code> topic과 연결된 이후 다시 빈 <em>user agent</em> 를 보낸다면 이 변경은 허용되지 않습니다. 빈 <em>user agent</em> 값은 무시됩니다.</p></div></div><div id="outline-container-Public and Private Fields" class=outline-2><h2 id="Public and Private Fields">Public and Private Fields</h2><div id="outline-text-Public and Private Fields" class=outline-text-2><p>Topic과 관련 구독들은 <code>public</code>, <code>private</code> 필드를 가지고 있습니다. 일반적으로, 이런 필드는 응용 프로그램에서 정의됩니다. 서버는 <code>fnd</code> topic을 제외하고 이러한 필드 구조를 강제하지 않습니다. 동시에, 클라이언트 소프트웨어는 상호 호환성을 위해 동일한 형식을 사용해야 합니다.</p><div id=outline-container-headline-33 class=outline-3><h3 id=headline-33>Public</h3><div id=outline-text-headline-33 class=outline-text-3><p>group topic과 p2p topic의 <code>public</code> 필드 형식은 현재 클라이언트 소프트웨어에서 <code>fn</code>, <code>photo</code> 필드만 사용되지만 추 후 <a href=https://en.wikipedia.org/wiki/VCard>vCard</a> 형태로 변경될 것으로 예상됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>vcard: {
</span></span><span class=line><span class=cl>  fn: &#34;John Doe&#34;, // string, formatted name
</span></span><span class=line><span class=cl>  n: {
</span></span><span class=line><span class=cl>    surname: &#34;Miner&#34;, // last of family name
</span></span><span class=line><span class=cl>    given: &#34;Coal&#34;, // first or given name
</span></span><span class=line><span class=cl>    additional: &#34;Diamond&#34;, // additional name, such as middle name or patronymic or nickname.
</span></span><span class=line><span class=cl>    prefix: &#34;Dr.&#34;, // prefix, such as honorary title or gender designation.
</span></span><span class=line><span class=cl>    suffix: &#34;Jr.&#34;, // suffix, such as &#39;Jr&#39; or &#39;II&#39;
</span></span><span class=line><span class=cl>  }, // object, user&#39;s structured name
</span></span><span class=line><span class=cl>  org: &#34;Most Evil Corp&#34;, // string, name of the organisation the user belongs to.
</span></span><span class=line><span class=cl>  title: &#34;CEO&#34;, // string, job title
</span></span><span class=line><span class=cl>  tel: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      type: &#34;HOME&#34;, // string, optional designation
</span></span><span class=line><span class=cl>      uri: &#34;tel:+17025551234&#34; // string, phone number
</span></span><span class=line><span class=cl>    }, ...
</span></span><span class=line><span class=cl>  ], // array of objects, list of phone numbers associated with the user
</span></span><span class=line><span class=cl>  email: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      type: &#34;WORK&#34;, // string, optional designation
</span></span><span class=line><span class=cl>      uri: &#34;email:alice@example.com&#34;, // string, email address
</span></span><span class=line><span class=cl>    }, ...
</span></span><span class=line><span class=cl>  ], // array of objects, list of user&#39;s email addresses
</span></span><span class=line><span class=cl>  impp: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      type: &#34;OTHER&#34;,
</span></span><span class=line><span class=cl>      uri: &#34;tinode:usrRkDVe0PYDOo&#34;, // string, email address
</span></span><span class=line><span class=cl>    }, ...
</span></span><span class=line><span class=cl>  ], // array of objects, list of user&#39;s IM handles
</span></span><span class=line><span class=cl>  photo: {
</span></span><span class=line><span class=cl>    type: &#34;jpeg&#34;, // image type
</span></span><span class=line><span class=cl>    data: &#34;...&#34; // base64-encoded binary image data
</span></span><span class=line><span class=cl>  } // object, avatar photo. Java does not have a useful bitmap class, so keeping it as bits here.
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p><code>fnd</code> topic의 <code>public</code> 필드는 <a href="#Query Language">검색 쿼리</a>를 나타내는 문자열이 될 것으로 예상됩니다.</p></div></div><div id=outline-container-headline-34 class=outline-3><h3 id=headline-34>Private</h3><div id=outline-text-headline-34 class=outline-text-3><p>group topic과 p2p topic의 <code>private</code> 필드 형식은 key-value 형태로 구성됩니다. 현재 정의된 키는 다음과 같습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>private: {
</span></span><span class=line><span class=cl>  comment: &#34;some comment&#34;, // string, optional user comment about a topic or a peer user
</span></span><span class=line><span class=cl>  arch: true, // boolean value indicating that the topic is archived by the user, i.e.
</span></span><span class=line><span class=cl>              // should not be shown in the UI with other non-archived topics.
</span></span><span class=line><span class=cl>  accepted: &#34;JRWS&#34; // string, &#39;given&#39; mode accepted by the user.
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>아직 적용되지는 않았지만 사용자 정의 필드는 <code>x-</code> 로 시작하여 그 뒤에 애플리케이션 이름이 와야 합니다(예: <code>x-myapp-value:"abc"</code>). 필드 타입은 <code>string</code>, <code>boolean</code>, <code>number</code> 또는 <code>null</code> 같은 원시 타입만 지원합니다.</p><p><code>fnd</code> topic의 <code>private</code> 필드는 <a href="#Query Language">검색 쿼리</a>를 나타내는 문자열이 될 것으로 예상됩니다.</p></div></div></div></div><div id="outline-container-Format of Content" class=outline-2><h2 id="Format of Content">Format of Content</h2><div id="outline-text-Format of Content" class=outline-text-2><p><code>{pub}</code>, <code>{data}</code> 메세지의 <code>content</code> 필드 형식은 응용 프로그램에서 정의되므레 서버는 이 필드에 특정 형식을 강요하지 않습니다. 클라이언트 소프트웨어는 상호 호환성을 위해 동일한 형식을 사용해야 합니다. 현재는 다음 두 가지 유형의 콘텐츠가 지원됩니다.</p><ul><li>Plain Text</li><li><a href=https://github.com/tinode/chat/blob/master/docs/drafty.md>Drafty</a></li></ul><p>Drafty를 사용한다면, 메세지 헤더에 <code>"head": {"mime": "text/x-drafty"}</code> 값을 셋팅해야 합니다.</p></div></div><div id="outline-container-Out-of-Band Handling of Large Files" class=outline-2><h2 id="Out-of-Band Handling of Large Files">Out-of-Band Handling of Large Files</h2><div id="outline-text-Out-of-Band Handling of Large Files" class=outline-text-2><p>대용량 파일은 전송 시 다양한 문제를 야기합니다.</p><ul><li>메세지가 데이터베이스 필드에 저장되기 때문에 데이터베이스가 제한됩니다.</li><li>메세지는 채팅 기록 다운로의 일부이므로 완전히 다운되어야 합니다.</li></ul><p>Tinode는 대용량 파일을 위해 업로드용 endpoint <code>/v0/file/u</code>, 다운로드용 endpoint <code>v0/files/s</code> 등 총 두 가지 endpoint를 제공합니다. 이 endpoint에 접근하기 위해선 <a href="#Connecting to the Server">API key</a>와 로그인 인증정보가 필요합니다. 서버는 아래와 같은 순서로 자격 증명을 확인합니다.</p><p><strong><strong>Login credentials</strong></strong></p><ul><li>HTTP header <code>Authorization</code> (<a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization)>https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Authorization)</a></li><li>URL query parameter <code>auth</code>, <code>secret</code> (/v0/file/s/abcdefg.jpeg?auth=…&amp;secret=…)</li><li>Form values <code>auth</code>, <code>secret</code></li><li>Cookies <code>auth</code> and <code>secret</code></li></ul><div id=outline-container-headline-37 class=outline-3><h3 id=headline-37>Uploading</h3><div id=outline-text-headline-37 class=outline-text-3><p>파일 업로드는 RFC 2388 multipart request를 생성 후 HTTP POST 형식으로 서버에 전송하는 방식으로 진행된다. 서버는 업로드 된 파일에 접근할 수 있는 URL이 포함된 <code>307 Temporary Redirect</code> 응답 또는 <code>200 OK</code> 와 <code>{ctrl}</code> 메세지를 포함한 responst body를 반환합니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ctrl: {
</span></span><span class=line><span class=cl>  params: {
</span></span><span class=line><span class=cl>    url: &#34;/v0/file/s/mfHLxDWFhfU.pdf&#34;
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  code: 200,
</span></span><span class=line><span class=cl>  text: &#34;ok&#34;,
</span></span><span class=line><span class=cl>  ts: &#34;2018-07-06T18:47:51.265Z&#34;
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p><code>307 Temporary Redirect</code> 응답을 받았다면 클라이언트는 반드시 전달받은 URL을 이용에 업로드를 다시 시도해야합니다. 이 후 모든 업로드는 기본 URL을 이용해 업로드를 시도해야합니다.</p><p><code>ctrl.params.url</code> 에는 현재 서버에 업로드된 파일의 위치를 나타냅니다. 이 경로는 <code>/v0/file/s/mfHLxDWFhfU.pdf</code> 같은 절대경로, 또는 <code>./mfHLxDWFhfU.pdf</code> 같은 상대경로, 또는 <code>mfHLxDWFhfU.pdf</code> 같은 단순한 파일명이 될 수 있습니다. 전체 경로를 제외한 모든 항목은 기본 다운로드 endpoint <code>/v0/file/s</code> 위치를 중심으로 나타냅니다. 예를 들어, 만약 <code>mfHLxDWFhfU.pdf</code> 을 응답값으로 받았다면 파일 위치는 <code>http(s)://current-tinode-server/v0/file/s/mfHLxDWFhfU.pdf</code> 가 됩니다.</p><p>업로드 직후, 또는 리디렉션 후 파일의 URL이 수신되면 클라이언트는 URL을 사용하여 업로드 된 파일과 함께 <code>{pub}</code> 메세지를 첨부 파일로 보낼 수 있습니다. URL은 <a href=https://github.com/tinode/chat/blob/master/docs/drafty.md>Dratfy</a>-formatted 형식의 <code>pub.content</code> 필드를 생성하거나 <code>pub.heade.attachments</code> 필드에서 참조하는데 사용됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pub: {
</span></span><span class=line><span class=cl>  id: &#34;121103&#34;,
</span></span><span class=line><span class=cl>  topic: &#34;grpnG99YhENiQU&#34;,
</span></span><span class=line><span class=cl>  head: {
</span></span><span class=line><span class=cl>    attachments: [&#34;/v0/file/s/sJOD_tZDPz0.jpg&#34;],
</span></span><span class=line><span class=cl>    mime: &#34;text/x-drafty&#34;
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  content: {
</span></span><span class=line><span class=cl>    ent: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      data: {
</span></span><span class=line><span class=cl>      mime: &#34;image/jpeg&#34;,
</span></span><span class=line><span class=cl>      name: &#34;roses-are-red.jpg&#34;,
</span></span><span class=line><span class=cl>      ref:  &#34;/v0/file/s/sJOD_tZDPz0.jpg&#34;,
</span></span><span class=line><span class=cl>      size: 437265
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>      tp: &#34;EX&#34;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>  fmt: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      at: -1,
</span></span><span class=line><span class=cl>    key:0,
</span></span><span class=line><span class=cl>    len:1
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  ]
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p><code>head.attachments</code> 필드에 URL을 나열하는 것이 중요합니다. Tinode 서버는 이 필드를 사용하여 업로드 된 파일의 갯수를 파악합니다. 필드의 list 길이가 0이 되면(예를 들어 URL이 들어있는 메세지가 삭제되거나 클라이언트가 head.attachments 필드에 URL을 포함하지 못했을 경우), 서버는 파일을 삭제하기 위해 garbage collection에 추가합니다. 상대경로 URL을 사용해야만 합니다. <code>head.attachments</code> 필드의 절대경로 URL는 무시됩니다. URL은 업로드에 대항 응답으로 반환된 <code>ctrl.params.url</code> 값이어야 합니다.</p></div></div><div id=outline-container-headline-38 class=outline-3><h3 id=headline-38>Downloading</h3><div id=outline-text-headline-38 class=outline-text-3><p>HTTP GET 형식으로 <code>/v0/files/s</code> URL로 요청하면 파일을 다운로드 할 수 있습니다. 클라이언트는 이 주소를 중심으로 상대경로를 파악해야 합니다. 예를 들어, <code>mfHLxDWFhfU.pdf</code> 또는 <code>./mfHLxDWFhfU.pdf</code> 값은 <code>/v0/file/s/mfHLxDWFhfU.pdf</code> URL로 서버에 요청해야 합니다.</p></div></div></div></div><div id=outline-container-headline-39 class=outline-2><h2 id=headline-39>Push Notifications</h2><div id=outline-text-headline-39 class=outline-text-2><p>Tinode는 푸시 알림을 처리하기 위해 컴파일 타임 어댑터를 사용합니다. 서버는 <a href=https://github.com/tinode/chat/blob/master/server/push/tnpg>Tinode Push Gateway</a>, <a href=https://firebase.google.com/docs/cloud-messaging/>Google FCM</a>, <code>stdout</code> 어댑터를 제공합니다. Tinode Push Gateway와 Google FCM은 Play Services와 함께 안드로이드를 지원하며(일부 중국폰은 지원하지 않을 수 있습니다.) iOS기기 및 사파리를 제외한 모든 메이저 웹 브라우저를 지원합니다. <code>stdout</code> 어댑터는 실제로 푸시 알림을 지원하지는 않습니다.이 어댑터는 디버깅이나 테스트, 로깅 등의 작업을 수행할 때 매우 유용합니다. <a href=https://intl.cloud.tencent.com/product/tpns>TNPS</a> 같은 다른 푸시 알림은 직접 어댑터를 작성할 수 있습니다.</p><p>만약 직접 커스텀 플러그인을 작성했다면, 알림 payload는 아래와 같은 형식을 따라야 합니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  topic: &#34;grpnG99YhENiQU&#34;, // Topic which received the message.
</span></span><span class=line><span class=cl>  xfrom: &#34;usr2il9suCbuko&#34;, // ID of the user who sent the message.
</span></span><span class=line><span class=cl>  ts: &#34;2019-01-06T18:07:30.038Z&#34;, // message timestamp in RFC3339 format.
</span></span><span class=line><span class=cl>  seq: &#34;1234&#34;, // sequential ID of the message (integer value sent as text).
</span></span><span class=line><span class=cl>  mime: &#34;text/x-drafty&#34;, // optional message MIME-Type.
</span></span><span class=line><span class=cl>  content: &#34;Lorem ipsum dolor sit amet, consectetur adipisci&#34;, // The first 80 characters of the message content as plain text.
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><div id=outline-container-headline-40 class=outline-3><h3 id=headline-40>Tinode Push Gateway</h3><div id=outline-text-headline-40 class=outline-text-3><p>Tinode Push Gateway(TNPG)는 Tinode를 대신하여 푸시 알림을 보내는 Tinode 독점 서비스입니다. 내부적으로 Google FCM을 사용하므로 FCM과 동일한 플랫폼을 지원합니다. TNPG의 주요 장점은 FCM보다 설정을 좀 더 쉽게 할 수 있다는 것입니다. 모바일 클라이언트를 다시 컴파일 할 필요가 없으며 서버만 업데이트 하면 됩니다.</p></div></div><div id=outline-container-headline-41 class=outline-3><h3 id=headline-41>Google FCM</h3><div id=outline-text-headline-41 class=outline-text-3><p><a href=https://firebase.google.com/docs/cloud-messaging/>Google FCM</a>은 <a href=https://developers.google.com/android/guides/overview>Android Play</a> 서비스, iPhone 및 iPad 기기 및 Safari를 제외한 모든 메이저 웹 브라우저를 지원합니다. FMC 모바일 클라이언트(iOS, Android)를 사용하려면 Google에서 얻은 사용자 인증 정보로 다시 컴파일해야 합니다. 자세한 내용은 <a href=https://github.com/tinode/chat/tree/master/server/push/fcm>여기</a>를 참고하세요.</p></div></div><div id=outline-container-headline-42 class=outline-3><h3 id=headline-42>Stdout</h3><div id=outline-text-headline-42 class=outline-text-3><p><code>stdout</code> 어댑터는 디버깅이나 로깅 작업에 매우 유용합니다. <code>STDOUT</code> 에 push payload를 전달하여 파일에 기록하거나 다른 프로세스에서 읽도록 할 수 있습니다.</p></div></div></div></div><div id=outline-container-headline-43 class=outline-2><h2 id=headline-43>Messagse</h2><div id=outline-text-headline-43 class=outline-text-2><p>메세지는 논리적 연관 데이터 세트입니다. 메세지는 JSON 형식의 UTF-8 텍스트로 전달됩니다.</p><p>모든 클라이언트가 서버로 메세지에는 <code>id</code> 필드가 있을 수 있습니다. 이는 클라이언트가 메시지를 수신하고 처리했다고 서버에게 알리는 수단으로서 사용됩니다. <code>id</code> 는 세션 고유 문자열이어야하지만 임의의 문자열이 될 수 있습니다. 서버는 JSON 유효성을 확인하는 것 외에는 어떤 해석을 시도하지 않습니다. <code>id</code> 는 서버가 클라이언트 메세지에 회신할 때 변경되지 않은 상태로 반환됩니다.</p><p>서버는 반드시 쌍따옴표로 감싼 필드명으로 이루어진 엄격한 JSON 규격을 준수해야 합니다. 간결함을 위해 아래의 표기법은 필드 이름과 외부 중괄호 주위의 쌍따옴표를 생략합니다. 예제에서는 설명을 위해서만 <code>//</code> 주석을 사용합니다. 주석은 실제 서버 통신에서는 사용할 수 없습니다.</p><p>어플리케이션 정의 데이터를 업데이트 하기 위한 데이터는 <code>{set}</code>, <code>private</code> 또는 <code>public</code> 같은 필드들이 있지만, 서버에서 데이터를 지우고자 할 때는 단일 유니코드 <code>␡~(</code>\u2421~) 문자가 있는 문자열을 사용하세요. 예를 들어, <code>"public": null</code> 을 보내면 해당 필드는 지워지지 않지만 <code>"public":"␡"</code> 을 보내면 지워집니다.</p><p>인식되지 않는 필드는 서버에서 자동으로 무시됩니다.</p><div id=outline-container-headline-44 class=outline-3><h3 id=headline-44>Client to Server Messages</h3><div id=outline-text-headline-44 class=outline-text-3><div id=outline-container-headline-45 class=outline-4><h4 id=headline-45><code>{hi}</code></h4><div id=outline-text-headline-45 class=outline-text-4><p>클라이언트가 서버에서 버전과 user agent 정보를 알리는 핸드쉐이크 메세지입니다. 이 메세지는 서버에 반드시 가장 먼저 보내야 합니다. 서버는 <code>{ctrl}</code> 에 서버 빌드 버전, wire 프로토콜 버전, long polling 방식의 경우 서버 세션 ID 및 sid 등등을 <code>ctrl.params</code> 필드에 담은 응답값을 반환합니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>hi: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;,     // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  ver: &#34;0.15.8-rc2&#34;, // string, version of the wire protocol supported by the client, required
</span></span><span class=line><span class=cl>  ua: &#34;JS/1.0 (Windows 10)&#34;, // string, user agent identifying client software,
</span></span><span class=line><span class=cl>                   // optional
</span></span><span class=line><span class=cl>  dev: &#34;L1iC2...dNtk2&#34;, // string, unique value which identifies this specific
</span></span><span class=line><span class=cl>                   // connected device for the purpose of push notifications; not
</span></span><span class=line><span class=cl>                   // interpreted by the server.
</span></span><span class=line><span class=cl>                   // see [Push notifications support](#push-notifications-support); optional
</span></span><span class=line><span class=cl>  platf: &#34;android&#34;, // string, underlying OS for the purpose of push notifications, one of
</span></span><span class=line><span class=cl>                   // &#34;android&#34;, &#34;ios&#34;, &#34;web&#34;; if missing, the server will try its best to
</span></span><span class=line><span class=cl>                   // detect the platform from the user agent string; optional
</span></span><span class=line><span class=cl>  lang: &#34;en-US&#34;    // human language of the client device; optional
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>user agent값인 <code>ua</code> 값은 가급적이면 <a href=http://tools.ietf.org/html/rfc7231#section-5.5.3>RFC 7231 section 5.5.3</a>의 권장사항을 따르겠지만 항상 따르는 것은 아닙니다. <code>ua</code>, <code>dev</code> 및 <code>lang</code> 값을 업데이트 하기 위해서 메세지를 두 번 이상 보낼 수 있습니다. 여러번 전송되는 경우 첫번째 메세지 이후의 메세지들의 <code>ver</code> 값은 첫번째 메세지와 동일하거나 아예 명시하지 않아야 합니다.</p></div></div><div id=outline-container-acc class=outline-4><h4 id=acc><code>{acc}</code></h4><div id=outline-text-acc class=outline-text-4><p><code>{acc}</code> 메세지는 사용자를 생성하거나 <code>tags</code> 정보를 수정, 또는 <code>scheme</code>, <code>secret</code> 값을 이용해 기존 사용자로 로그인을 할 수 있습니다. 계정을 새로 생성하려면 <code>user</code> 필드에 <code>new</code> 값을 설정하고 선택적으로 뒤에 문자열을 추가할 수 있습니다(예: <code>newr15gsr</code>). 인증된 세션이나 인증 세션은 <code>{acc}</code> 메세지를 보내 새 사용자를 만들 수 있습니다. 인증 데이터를 업데이트하거나 현재 사용자의 인증정보를 확인하려면 사용자를 설정하지 않은 상태로 유지합니다.</p><p><code>{acc}</code> 메세지는 이미 존재하는 사용자의 <code>desc</code>, <code>cred</code> <strong>값을 수정할 수 없습니다.</strong> 대신 <code>me</code> topic을 사용해 업데이트하세요.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>acc: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  user: &#34;new&#34;, // string, &#34;new&#34; to create a new user, default: current user, optional
</span></span><span class=line><span class=cl>  token: &#34;XMgS...8+BO0=&#34;, // string, authentication token to use for the request if the
</span></span><span class=line><span class=cl>               // session is not authenticated, optional
</span></span><span class=line><span class=cl>  status: &#34;ok&#34;, // change user&#39;s status; no default value, optional.
</span></span><span class=line><span class=cl>  scheme: &#34;basic&#34;, // authentication scheme for this account, required;
</span></span><span class=line><span class=cl>               // &#34;basic&#34; and &#34;anon&#34; are currently supported for account creation.
</span></span><span class=line><span class=cl>  secret: base64encode(&#34;username:password&#34;), // string, base64 encoded secret for the chosen
</span></span><span class=line><span class=cl>              // authentication scheme; to delete a scheme use a string with a single DEL
</span></span><span class=line><span class=cl>              // Unicode character &#34;\u2421&#34;; &#34;token&#34; and &#34;basic&#34; cannot be deleted
</span></span><span class=line><span class=cl>  login: true, // boolean, use the newly created account to authenticate current session,
</span></span><span class=line><span class=cl>              // i.e. create account and immediately use it to login.
</span></span><span class=line><span class=cl>  tags: [&#34;alice johnson&#34;,... ], // array of tags for user discovery; see &#39;fnd&#39; topic for
</span></span><span class=line><span class=cl>              // details, optional (if missing, user will not be discoverable other than
</span></span><span class=line><span class=cl>              // by login)
</span></span><span class=line><span class=cl>  cred: [  // account credentials which require verification, such as email or phone number.
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      meth: &#34;email&#34;, // string, verification method, e.g. &#34;email&#34;, &#34;tel&#34;, &#34;recaptcha&#34;, etc.
</span></span><span class=line><span class=cl>      val: &#34;alice@example.com&#34;, // string, credential to verify such as email or phone
</span></span><span class=line><span class=cl>      resp: &#34;178307&#34;, // string, verification response, optional
</span></span><span class=line><span class=cl>      params: { ... } // parameters, specific to the verification method, optional
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>  ...
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  desc: {  // object, user initialisation data closely matching that of table
</span></span><span class=line><span class=cl>           // initialisation; used only when creating an account; optional
</span></span><span class=line><span class=cl>    defacs: {
</span></span><span class=line><span class=cl>      auth: &#34;JRWS&#34;, // string, default access mode for peer to peer conversations
</span></span><span class=line><span class=cl>                   // between this user and other authenticated users
</span></span><span class=line><span class=cl>      anon: &#34;N&#34;  // string, default access mode for peer to peer conversations
</span></span><span class=line><span class=cl>                 // between this user and anonymous (un-authenticated) users
</span></span><span class=line><span class=cl>    }, // Default access mode for user&#39;s peer to peer topics
</span></span><span class=line><span class=cl>    public: { ... }, // application-defined payload to describe user,
</span></span><span class=line><span class=cl>                // available to everyone
</span></span><span class=line><span class=cl>    private: { ... } // private application-defined payload available only to user
</span></span><span class=line><span class=cl>                // through &#39;me&#39; topic
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>서버는 <code>{ctrl}</code> 에 새 사용자의 정보를 담고 있는 <code>params</code> 를 포함한 응답값을 반환합니다. 만약 <code>desc.defacs</code> 값이 없다면, 서버는 서버 기본 액세스 값을 할당합니다.</p><p>계정 생성에 지원되는 유일한 인증 방법은 <code>basic</code>, <code>anonymous</code> 입니다.</p></div></div><div id=outline-container-login class=outline-4><h4 id=login><code>{login}</code></h4><div id=outline-text-login class=outline-text-4><p>로그인은 현재 세션을 인증하는 데 사용됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>login: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;,     // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  scheme: &#34;basic&#34;, // string, authentication scheme; &#34;basic&#34;,
</span></span><span class=line><span class=cl>                   // &#34;token&#34;, and &#34;reset&#34; are currently supported
</span></span><span class=line><span class=cl>  secret: base64encode(&#34;username:password&#34;), // string, base64-encoded secret for the chosen
</span></span><span class=line><span class=cl>                  // authentication scheme, required
</span></span><span class=line><span class=cl>  cred: [
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      meth: &#34;email&#34;, // string, verification method, e.g. &#34;email&#34;, &#34;tel&#34;, &#34;captcha&#34;, etc, required
</span></span><span class=line><span class=cl>      resp: &#34;178307&#34; // string, verification response, required
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>  ...
</span></span><span class=line><span class=cl>  ],   // response to a request for credential verification, optional
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>서버는 <code>{login}</code> 패킷에 <code>{ctrl}</code> 메세지를 응답값으로 반환합니다. 메세지의 <code>params</code> 에는 현재 로그인 한 사용자의 <code>user</code> 정보가 포함되어 있습니다. <code>token</code> 값에는 인증에 사용할 수 있는 암호화 된 문자열이 포함되어 있습니다. <code>expires</code> 값은 토큰의 만료시간을 나타냅니다.</p></div></div><div id=outline-container-sub class=outline-4><h4 id=sub><code>{sub}</code></h4><div id=outline-text-sub class=outline-text-4><p><code>{sub}</code> 패킷은 다음과 같은 기능을 제공합니다.</p><ul><li>새 topic 생성</li><li>이미 존재하는 topic 구독</li><li>이전에 구독한 topic에 세션 연결</li><li>topic 데이터 가져오기</li></ul><p>사용자는 <code>{sub}</code> 패킷의 <code>topic</code> 필드에 <code>"new"</code> 값을 담아 전송하면 새 그룹 topic을 생성할 수 있습니다. 서버는 topic을 생성하고 새로 생성된 topic의 이름을 세션에 응답값으로 반환합니다.</p><p>사용자는 <code>{sub}</code> 패킷의 <code>topic</code> 필드에 대상 사용자의 ID값을 담아 전송하면 1대1(peer to peer) topic을 생성할 수 있습니다.</p><p>topic을 새로 생성하면 생성한 사용자는 항상 해당 topic을 구독하며 현재 연결된 세션에 topic이 연결됩니다.</p><p>사용자가 topic과 관계가 없을 경우 <code>{sub}</code> 패킷을 보내면 topic이 생성됩니다. 구독은 세션의 사용자와 topic 사이에 관계가 연결되는 것을 의미합니다.</p><p>topic에 참여하는 것은 세션이 topic에서 제공하는 콘텐츠를 소비하는 것을 의미합니다. 서버는 context에 따라 구독과 가입/연결을 자동으로 구분합니다. 만약 사용자가 topic과 관련이 없을 경우, 서버는 사용자를 해당 topic을 구독시키고 현재 세션을 topic에 연결합니다. 만약 사용자가 topic과 관련이 있을 경우, 세션을 topic에 연결하기만 합니다. 구독할 때, 서버는 사용자의 접근 권한과 topic의 접근 제어목록을 비교하여 접근을 허용 또는 거부할 수 있으며, topic 관리자에게 접근 승인을 요청할 수 있습니다.</p><p>서버는 <code>{sub}</code> 패킷에 대한 응답값으로 <code>{ctrl}</code> 을 반환합니다.</p><p><code>{sub}</code> 메세지는 <code>{get}</code>, <code>{set}</code> 메세지에 각각 대응하는 <code>{get}</code>, <code>{set}</code> 필드를 포함할 수 있습니다. 포함된 경우 서버는 동일한 이 후 동일한 topic에 대한 subsequent는 동일한 <code>{set}</code>, <code>{get}</code> 메세지로 처리됩니다. 응답값에는 <code>{meta}</code>, <code>{data}</code> 메세지가 포함될 수 있습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>sub: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;,  // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;me&#34;,  // topic to be subscribed or attached to
</span></span><span class=line><span class=cl>  bkg: true,    // request to attach to topic is issued by an automated agent, server should delay sending
</span></span><span class=line><span class=cl>                // presence notifications because the agent is expected to disconnect very quickly
</span></span><span class=line><span class=cl>  // Object with topic initialisation data, new topics &amp; new
</span></span><span class=line><span class=cl>  // subscriptions only, mirrors {set} message
</span></span><span class=line><span class=cl>  set: {
</span></span><span class=line><span class=cl>  // New topic parameters, mirrors {set desc}
</span></span><span class=line><span class=cl>    desc: {
</span></span><span class=line><span class=cl>      defacs: {
</span></span><span class=line><span class=cl>        auth: &#34;JRWS&#34;, // string, default access for new authenticated subscribers
</span></span><span class=line><span class=cl>        anon: &#34;N&#34;    // string, default access for new anonymous (un-authenticated)
</span></span><span class=line><span class=cl>                     // subscribers
</span></span><span class=line><span class=cl>      }, // Default access mode for the new topic
</span></span><span class=line><span class=cl>      public: { ... }, // application-defined payload to describe topic
</span></span><span class=line><span class=cl>      private: { ... } // per-user private application-defined content
</span></span><span class=line><span class=cl>    }, // object, optional
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Subscription parameters, mirrors {set sub}. &#39;sub.user&#39; must be blank
</span></span><span class=line><span class=cl>    sub: {
</span></span><span class=line><span class=cl>      mode: &#34;JRWS&#34;, // string, requested access mode, optional;
</span></span><span class=line><span class=cl>                   // default: server-defined
</span></span><span class=line><span class=cl>    }, // object, optional
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    tags: [ // array of strings, update to tags (see fnd topic description), optional.
</span></span><span class=line><span class=cl>        &#34;email:alice@example.com&#34;, &#34;tel:1234567890&#34;
</span></span><span class=line><span class=cl>    ],
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    cred: { // update to credentials, optional.
</span></span><span class=line><span class=cl>      meth: &#34;email&#34;, // string, verification method, e.g. &#34;email&#34;, &#34;tel&#34;, &#34;recaptcha&#34;, etc.
</span></span><span class=line><span class=cl>      val: &#34;alice@example.com&#34;, // string, credential to verify such as email or phone
</span></span><span class=line><span class=cl>      resp: &#34;178307&#34;, // string, verification response, optional
</span></span><span class=line><span class=cl>      params: { ... } // parameters, specific to the verification method, optional
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  get: {
</span></span><span class=line><span class=cl>    // Metadata to request from the topic; space-separated list, valid strings
</span></span><span class=line><span class=cl>    // are &#34;desc&#34;, &#34;sub&#34;, &#34;data&#34;, &#34;tags&#34;; default: request nothing; unknown strings are
</span></span><span class=line><span class=cl>    // ignored; see {get  what} for details
</span></span><span class=line><span class=cl>    what: &#34;desc sub data&#34;, // string, optional
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Optional parameters for {get what=&#34;desc&#34;}
</span></span><span class=line><span class=cl>    desc: {
</span></span><span class=line><span class=cl>      ims: &#34;2015-10-06T18:07:30.038Z&#34; // timestamp, &#34;if modified since&#34; - return
</span></span><span class=line><span class=cl>              // public and private values only if at least one of them has been
</span></span><span class=line><span class=cl>              // updated after the stated timestamp, optional
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Optional parameters for {get what=&#34;sub&#34;}
</span></span><span class=line><span class=cl>    sub: {
</span></span><span class=line><span class=cl>      ims: &#34;2015-10-06T18:07:30.038Z&#34;, // timestamp, &#34;if modified since&#34; - return
</span></span><span class=line><span class=cl>              // public and private values only if at least one of them has been
</span></span><span class=line><span class=cl>              // updated after the stated timestamp, optional
</span></span><span class=line><span class=cl>    user: &#34;usr2il9suCbuko&#34;, // string, return results for a single user,
</span></span><span class=line><span class=cl>                            // any topic other than &#39;me&#39;, optional
</span></span><span class=line><span class=cl>    topic: &#34;usr2il9suCbuko&#34;, // string, return results for a single topic,
</span></span><span class=line><span class=cl>                            // &#39;me&#39; topic only, optional
</span></span><span class=line><span class=cl>      limit: 20 // integer, limit the number of returned objects
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // Optional parameters for {get what=&#34;data&#34;}, see {get what=&#34;data&#34;} for details
</span></span><span class=line><span class=cl>    data: {
</span></span><span class=line><span class=cl>      since: 123, // integer, load messages with server-issued IDs greater or equal
</span></span><span class=line><span class=cl>            // to this (inclusive/closed), optional
</span></span><span class=line><span class=cl>      before: 321, // integer, load messages with server-issued sequential IDs less
</span></span><span class=line><span class=cl>            // than this (exclusive/open), optional
</span></span><span class=line><span class=cl>      limit: 20, // integer, limit the number of returned objects,
</span></span><span class=line><span class=cl>                 // default: 32, optional
</span></span><span class=line><span class=cl>    } // object, optional
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p><a href="#Public and Private Fields">Public and Private Fields</a> 섹션을 참고하여 <code>private</code> 와 <code>public</code> 필드 구성방법을 확인하세요.</p></div></div><div id=outline-container-headline-49 class=outline-4><h4 id=headline-49><code>{leave}</code></h4><div id=outline-text-headline-49 class=outline-text-4><p><code>{sub}</code> 메세지에 대응하는 메세지입니다. 이 메세지는 아래와 같은 두가지 기능을 제공합니다.</p><ul><li>구독취소 없이 topic을 탈퇴합니다(<code>unsub=false</code>).</li><li>구독을 취소합니다(<code>unsub=true</code>).</li></ul><p>서버는 <code>{leave}</code> 패킷에 대한 응답값으로 <code>{ctrl}</code> 을 반환합니다. 구독취소 없이 topic을 탈퇴할 경우 현재 세션에서만 구독취소가 됩니다. 구독취소를 포함해서 탈퇴할 경우 사용자의 모든 세션에서 탈퇴가 이루어집니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>leave: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;,  // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;,   // string, topic to leave, unsubscribe, or
</span></span><span class=line><span class=cl>                              // delete, required
</span></span><span class=line><span class=cl>  unsub: true // boolean, leave and unsubscribe, optional, default: false
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-pub class=outline-4><h4 id=pub><code>{pub}</code></h4><div id=outline-text-pub class=outline-text-4><p>topic의 구독자들에게 콘텐츠를 발송하는 메세지입니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pub: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic to publish to, required
</span></span><span class=line><span class=cl>  noecho: false, // boolean, suppress echo (see below), optional
</span></span><span class=line><span class=cl>  head: { key: &#34;value&#34;, ... }, // set of string key-value pairs,
</span></span><span class=line><span class=cl>               // passed to {data} unchanged, optional
</span></span><span class=line><span class=cl>  content: { ... }  // object, application-defined content to publish
</span></span><span class=line><span class=cl>               // to topic subscribers, required
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>topic 구독자들은 <code>content</code> 가 포함된 <a href=#data><code>{data}</code></a> 패킷을 수신합니다. 기본적으로 원래 세션은 현재 topic에 연결된 다른 세션과 마찬가지로 <code>{data}</code> 의 사본을 가져옵니다. 세션이 방금 발송한 메세지의 복사본을 받지 않으려면 <code>noecho</code> 값을 <code>true</code> 로 설정합니다.</p><p><a href="#Format of Content">Format of Content</a> 섹션을 참고하여 <code>content</code> 필드 구성방법을 확인하세요.</p><p>다음 목록은 <code>head</code> 필드를 위해 정의된 내용들입니다.</p><ul><li><code>attachments</code>: 이 메세지에 포함된 미디어의 경로를 나타냅니다: <code>["/v0/file/s/sJOD_tZDPz0.jpg"]</code></li><li><code>auto</code>: 챗봇이나 자동 응답기처럼 자동으로 발송된 메세지의 경우 <code>true</code> 값이 할당됩니다.</li><li><code>forwarded</code>: 해당 메세지가 포워딩 된 메세지인지 여부를 나타냅니다. 원본 메세지의 고유 ID값이 할당됩니다: <code>"grp1XUtEhjv6HND:123"</code></li><li><code>hashtags</code>: 해시태그 목록을 <code>#</code> 기호없이 나타냅니다: <code>["onehash", "twohash"]</code></li><li><code>mentions</code>: 언급하려는 사용자의 고유 아이디(<code>@alice</code>)들을 나타냅니다(~~).</li><li><code>mime</code>: 메세지 내용의 MIME-type을 나타냅니다(<code>"text/x-drafty"</code>). null값이거나 해당 값이 누락됐을 경우엔 <code>"text/plain"</code> 값으로 간주합니다.</li><li><code>priority</code>: 메세지 표시 우선 순위를 나타냅니다. 메세지가 일정 시간동안 더 눈에 띄게 표시되어야 한다는 내용을 나타냅니다. 현재는 <code>"high"</code> 값만 정의되어 있는 상태입니다(<code>{"level": "high", "expires": "2019-10-06T18:07:30.038Z"}</code>). <code>priority</code> 값은 topic 소유자 또는 관리자(<code>A</code> permission)만 설정할 수 있습니다. <code>"expires"</code> 값은 옵션입니다.</li><li><code>replace</code>: 다른 메세지를 수정/대체하는 메세지인지 여부를 나타냅니다. 수정/대체하고자 하는 메세지의topic 고유의 아이디를 나타냅니다: <code>":123"</code></li><li><code>reply</code>: 다른 메세지에 대한 리플 여부를 나타냅니다. 원본 메세지의 고유 ID값을 나타냅니다:~"grp1XUtEhjv6HND:123"~</li><li><code>sender</code>: 서버가 해당 메세지를 전송할 때 원본 메세지를 발송한 사람의 고유 아이디 값을 나타냅니다: <code>"usr1XUtEhjv6HND"</code></li><li><code>thread</code>: an indicator that the message is a part of a conversation thread, a topic-unique ID of the first message in the thread, <code>":123"</code>; <code>thread</code> is intended for tagging a flat list of messages as opposite to a creating a tree.</li></ul><p>어플리케이션 별 필드는 <code>x-&lt;application-name></code> 로 시작해야 합니다. 서버는 아직 이 규칙을 적용하지 않지만 향 후 이 규칙이 적용될 수 있습니다.</p><p>메세지의 고유 아이디는 가능하다면 <code>"grp1XUtEhjv6HND:123"</code> 처럼 반드시 <code>&lt;topic_name>:&lt;seqId></code> 형식으로 시작해야 합니다. 만약 <code>":123"</code> 처럼 topic을 누락했다면 현재 topic으로 간주합니다.</p></div></div><div id=outline-container-headline-51 class=outline-4><h4 id=headline-51><code>{get}</code></h4><div id=outline-text-headline-51 class=outline-text-4><p>설명, 구독자 목록 또는 쿼리 메세지 기록같은 메타데이터에 대한 쿼리 topic입니다. 전체 응답을 받으려면 요청하는 사용자가 <a href=#sub>구독하고 topic에 소속</a>되어 있어야 합니다. 일부 제한된 <code>desc</code>, <code>sub</code> 정보의 경우엔 소속되어 있지 않아도 조회할 수 있습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>get: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, name of topic to request data from
</span></span><span class=line><span class=cl>  what: &#34;sub desc data del cred&#34;, // string, space-separated list of parameters to query;
</span></span><span class=line><span class=cl>                        // unknown values are ignored; required
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional parameters for {get what=&#34;desc&#34;}
</span></span><span class=line><span class=cl>  desc: {
</span></span><span class=line><span class=cl>    ims: &#34;2015-10-06T18:07:30.038Z&#34; // timestamp, &#34;if modified since&#34; - return
</span></span><span class=line><span class=cl>          // public and private values only if at least one of them has been
</span></span><span class=line><span class=cl>          // updated after the stated timestamp, optional
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional parameters for {get what=&#34;sub&#34;}
</span></span><span class=line><span class=cl>  sub: {
</span></span><span class=line><span class=cl>    ims: &#34;2015-10-06T18:07:30.038Z&#34;, // timestamp, &#34;if modified since&#34; - return
</span></span><span class=line><span class=cl>          // public and private values only if at least one of them has been
</span></span><span class=line><span class=cl>          // updated after the stated timestamp, optional
</span></span><span class=line><span class=cl>    user: &#34;usr2il9suCbuko&#34;, // string, return results for a single user,
</span></span><span class=line><span class=cl>                          // any topic other than &#39;me&#39;, optional
</span></span><span class=line><span class=cl>    topic: &#34;usr2il9suCbuko&#34;, // string, return results for a single topic,
</span></span><span class=line><span class=cl>                           // &#39;me&#39; topic only, optional
</span></span><span class=line><span class=cl>    limit: 20 // integer, limit the number of returned objects
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional parameters for {get what=&#34;data&#34;}
</span></span><span class=line><span class=cl>  data: {
</span></span><span class=line><span class=cl>    since: 123, // integer, load messages with server-issued IDs greater or equal
</span></span><span class=line><span class=cl>                // to this (inclusive/closed), optional
</span></span><span class=line><span class=cl>    before: 321, // integer, load messages with server-issed sequential IDs less
</span></span><span class=line><span class=cl>               // than this (exclusive/open), optional
</span></span><span class=line><span class=cl>    limit: 20, // integer, limit the number of returned objects, default: 32,
</span></span><span class=line><span class=cl>               // optional
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional parameters for {get what=&#34;del&#34;}
</span></span><span class=line><span class=cl>  del: {
</span></span><span class=line><span class=cl>    since: 5, // integer, load deleted ranges with the delete transaction IDs greater
</span></span><span class=line><span class=cl>              // or equal to this (inclusive/closed), optional
</span></span><span class=line><span class=cl>    before: 12, // integer, load deleted ranges with the delete transaction IDs less
</span></span><span class=line><span class=cl>                // than this (exclusive/open), optional
</span></span><span class=line><span class=cl>    limit: 25, // integer, limit the number of returned objects, default: 32,
</span></span><span class=line><span class=cl>               // optional
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><ul><li><code>{get what="desc"}</code></li></ul><p>쿼리 topic에 대해 설명합니다. 서버는 <code>{meta}</code> 메세지에 요청한 데이터를 첨부하여 반환합니다. 자세한 내용은 <code>{meta}</code> 데이터를 참고하세요. <code>ims</code> 값이 정의되어 있고 데이터가 업데이트 되지 않았다면, 메세지는 <code>public</code>, <code>private</code> 필드를 생략합니다.</p><p>제한된 정보는 topic에 <a href=#sub>소속</a>되어 있지 않아도 가능합니다.</p><p><a href="#Public and Private Fields">Public and Private Fields</a> 섹션을 참고하여 <code>private</code> 와 <code>public</code> 필드 구성방법을 확인하세요.</p><ul><li><code>{get what="sub"}</code></li></ul><p>구독중인 사용자 목록을 요청합니다. 서버는 <code>{meta}</code> 메세지에 요청한 구독중인 사용자 목록을 첨부하여 반환합니다. 자세한 내용은 <code>{meta}</code> 데이터를 참고하세요. <code>me</code> topic에 이 쿼리를 전송할 경우엔 내가 구독하고 있는 목록을 반환합니다. <code>ims</code> 값이 정의되어 있고 데이터가 업데이트 되지 않았다면, 메세지는 <code>{ctrl}</code> 패킷에 "not modified"를 포함한 메세지를 반환합니다.</p><p>topic에 <a href=#sub>소속</a>되지 않고 사용자의 구독 목록만을 반환합니다.</p><ul><li><code>{get what="tags"}</code></li></ul><p>인덱싱 된 태그들을 요청합니다. 서버는 <code>{meta}</code> 메세지에 태그 문자열 목록을 첨부하여 반환합니다. 자세한 내용은 <code>{meta}</code>, <code>{fnd}</code> topic을 참고하세요. <code>me</code> 와 group topic만 지원합니다.</p><ul><li><code>{get what="data"}</code></li></ul><p>메세지 기록을 요청합니다. 서버는 전달받은 쿼리의 <code>data</code> 필드값과 동일한 메세지들은 <code>{data}</code> 패킷에 담아 반환합니다. 데이터 메세지의 <code>id</code> 필드는 데이터 메세지의 일반 필드이므로 제공되지 않습니다. 모든 <code>{data}</code> 패킷 전송이 완료되면 <code>{ctrl}</code> 메세지가 전송됩니다.</p><ul><li><code>{get what="del"}</code></li></ul><p>기록을 지웁니다. 서버는 <code>{meta}</code> 메세지에 메세지 삭제 범위를 첨부하여 반환합니다.</p><ul><li><code>{get what="cred"}</code></li></ul><p>Query <a href=#credentail-validation>credentials</a>. 서버는 <code>{meta}</code> 메세지에 인증 목록을 첨부하여 반환합니다. <code>me</code> topic만 지원합니다.</p></div></div><div id=outline-container-headline-52 class=outline-4><h4 id=headline-52><code>{set}</code></h4><div id=outline-text-headline-52 class=outline-text-4><p>topic의 메타데이터 수정, 또는 메세지나 topic을 삭제합니다. 요청하는 사용자는 일반적으로 topic을 <a href=#sub>구독하고 소속</a>되어 있어야 합니다. <code>desc.private</code> 와 요청한 사용자의 <code>sub.mode</code> 값만 구독하지 않고도 수정할 수 있습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>set: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, name of topic to update, required
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional payload to update topic description
</span></span><span class=line><span class=cl>  desc: {
</span></span><span class=line><span class=cl>    defacs: { // new default access mode
</span></span><span class=line><span class=cl>      auth: &#34;JRWP&#34;,  // access permissions for authenticated users
</span></span><span class=line><span class=cl>      anon: &#34;JRW&#34; // access permissions for anonymous users
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    public: { ... }, // application-defined payload to describe topic
</span></span><span class=line><span class=cl>    private: { ... } // per-user private application-defined content
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional payload to update subscription(s)
</span></span><span class=line><span class=cl>  sub: {
</span></span><span class=line><span class=cl>    user: &#34;usr2il9suCbuko&#34;, // string, user affected by this request;
</span></span><span class=line><span class=cl>                            // default (empty) means current user
</span></span><span class=line><span class=cl>    mode: &#34;JRWP&#34; // string, access mode change, either given (&#39;user&#39;
</span></span><span class=line><span class=cl>                 // is defined) or requested (&#39;user&#39; undefined)
</span></span><span class=line><span class=cl>  }, // object, payload for what == &#34;sub&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Optional update to tags (see fnd topic description)
</span></span><span class=line><span class=cl>  tags: [ // array of strings
</span></span><span class=line><span class=cl>    &#34;email:alice@example.com&#34;, &#34;tel:1234567890&#34;
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  cred: { // Optional update to credentials.
</span></span><span class=line><span class=cl>    meth: &#34;email&#34;, // string, verification method, e.g. &#34;email&#34;, &#34;tel&#34;, &#34;recaptcha&#34;, etc.
</span></span><span class=line><span class=cl>    val: &#34;alice@example.com&#34;, // string, credential to verify such as email or phone
</span></span><span class=line><span class=cl>    resp: &#34;178307&#34;, // string, verification response, optional
</span></span><span class=line><span class=cl>    params: { ... } // parameters, specific to the verification method, optional
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-53 class=outline-4><h4 id=headline-53><code>{del}</code></h4><div id=outline-text-headline-53 class=outline-text-4><p>메세지, 구독, topic, 사용자 등등을 삭제할 수 있습니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>del: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic affected, required for &#34;topic&#34;, &#34;sub&#34;,
</span></span><span class=line><span class=cl>               // &#34;msg&#34;
</span></span><span class=line><span class=cl>  what: &#34;msg&#34;, // string, one of &#34;topic&#34;, &#34;sub&#34;, &#34;msg&#34;, &#34;user&#34;, &#34;cred&#34;; what
</span></span><span class=line><span class=cl>               // to delete - the entire topic, a subscription, some or all messages,
</span></span><span class=line><span class=cl>               // a user, a credential; optional, default: &#34;msg&#34;
</span></span><span class=line><span class=cl>  hard: false, // boolean, request to hard-delete vs mark as deleted; in case of
</span></span><span class=line><span class=cl>               // what=&#34;msg&#34; delete for all users vs current user only;
</span></span><span class=line><span class=cl>               // optional, default: false
</span></span><span class=line><span class=cl>  delseq: [{low: 123, hi: 125}, {low: 156}], // array of ranges of message IDs
</span></span><span class=line><span class=cl>               // to delete, inclusive-exclusive, i.e. [low, hi), optional
</span></span><span class=line><span class=cl>  user: &#34;usr2il9suCbuko&#34; // string, user being deleted (what=&#34;user&#34;) or whose
</span></span><span class=line><span class=cl>               // subscription is being deleted (what=&#34;sub&#34;), optional
</span></span><span class=line><span class=cl>  cred: { // credential to delete (&#39;me&#39; topic only).
</span></span><span class=line><span class=cl>    meth: &#34;email&#34;, // string, verification method, e.g. &#34;email&#34;, &#34;tel&#34;, etc.
</span></span><span class=line><span class=cl>    val: &#34;alice@example.com&#34; // string, credential being deleted
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><ul><li><code>what="msg"</code></li></ul><p>사용자는 soft-delete(<code>hard=false</code>: 기본값) 또는 hard-delete(<code>hard=true</code>) 형태로 메세지를 삭제할 수 있습니다. soft-delete는 요청한 사용자에게는 삭제되겠지만 스토리지에는 여전히 데이터가 남아있습니다. soft-delete를 하기 위해서는 <code>R</code> 권한이 필요합니다. hard-delete는 메세지가 남아있는 모든 스토리지(<code>head</code>, <code>content</code>)에서 메세지가 삭제됩니다. 이는 모든 사용자가 영향을 받습니다. hard-delete를 하기 위해서는 <code>D</code> 권한이 필요합니다. 메세지는 <code>delseq</code> 파라메터를 이용해 한 건 또는 여러 건을 한번에 삭제할 수 있습니다. 각 삭제 동작에는 각각의 고유한 <code>delete ID</code> 가 할당됩니다. The greatest <code>delete ID</code> is reported back in the <code>clear</code> of the <code>{meta}</code> message.</p><ul><li><code>what="sub"</code></li></ul><p>구독을 삭제하면 topic 구독자에서 지정된 사용자가 삭제됩니다. 이 동작은 <code>A</code> 권한이 필요합니다. 사용자는 자기 자신의 구독을 삭제할 수 없습니다. 대신에 <code>{leave}</code> 를 사용하세요. 구독을 soft-delete(기본값) 했다면, 실제 데이터베이스에서 레코드를 삭제하지 않고 삭제된 것으로 표시됩니다.</p><ul><li><code>what="topic"</code></li></ul><p>topic과 topic에 포함된 모든 구독 및 메세지를 삭제합니다. topic의 소유자만 삭제할 수 있습니다.</p><ul><li><code>what="user"</code></li></ul><p>사용자 삭제는 매우 무거운 작업입니다. 주의하세요.</p><ul><li><code>what="cred"</code></li></ul><p>인증정보를 삭제합니다. 유효한 인증정보와 인증 시도가 없는 인증정보는 삭제됩니다. 유효하지 않은 인증정보는 일시 삭제되어 같은 사용자가 재사용 할 수 없습니다.</p></div></div><div id=outline-container-headline-54 class=outline-4><h4 id=headline-54><code>{note}</code></h4><div id=outline-text-headline-54 class=outline-text-4><p>topic에 소속된 다른 클라이언트에게 전송 확인, 타이핑 알림같은 정보를 전달하기 위해 클라이언트에서 생성된 임시 알림입니다. 이 메세지는 "fire and forget" 방식으로써, 디스크에 기록되지 않고 서버가 인증해주지도 않습니다. 유효하지 않은 것으로 간주되는 메세지는 자동으로 삭제됩니다. <code>{note.recv}</code> 및 <code>{note.read}</code> 는 서버의 영구 상태를 변경합니다. 데이터는 <code>{meta.sub}</code> 메세지의 해당 필드에 저장 및 기독됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>note: {
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic to notify, required
</span></span><span class=line><span class=cl>  what: &#34;kp&#34;, // string, one of &#34;kp&#34; (key press), &#34;read&#34; (read notification),
</span></span><span class=line><span class=cl>              // &#34;rcpt&#34; (received notification), any other string will cause
</span></span><span class=line><span class=cl>              // message to be silently ignored, required
</span></span><span class=line><span class=cl>  seq: 123,   // integer, ID of the message being acknowledged, required for
</span></span><span class=line><span class=cl>              // rcpt &amp; read
</span></span><span class=line><span class=cl>  unread: 10  // integer, client-reported total count of unread messages, optional.
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>현재 인식되는 값들은 아래와 같습니다.</p><ul><li>kp: key press, 타이핑 알림을 의미합니다. 현재 사용자가 새 메세지를 작성하고 있음을 의미합니다.</li><li>recv: 클라이언트 소프트웨어가 <code>{data}</code> 메세지를 수신하였지만 사용자가 아직 읽지 않은 상태를 의미합니다.</li><li>read: 사용자가 <code>{data}</code> 메세지를 읽었음을 의미합니다. <code>recv</code> 를 포함하고 있습니다.</li></ul><p><code>read</code>, <code>recv</code> 알림은 클라이언트가 아직 읽지 않은 메세지의 총 갯수를 나타내는 <code>unread</code> 필드를 포함할 수 있습니다. 각 사용자별 <code>unread</code> 갯수는 서버가 결정합니다. 이 갯수는 새 <code>{data}</code> 메세지가 사용자에게 전송될 때 증가하고 <code>{note unread=...}</code> 메세지에서 전송한 값으로 재설정됩니다. <code>unread</code> 값은 절대 서버에 의해서 줄어들지 않습니다. 이 값은 iOS에서 알림 뱃지를 표시하기 위한 푸시 알림에 포함됩니다.</p></div></div></div></div><div id=outline-container-headline-55 class=outline-3><h3 id=headline-55>Server to Client Messages</h3><div id=outline-text-headline-55 class=outline-text-3><p>특정 요청에 대한 응답으로 생성된 세션에 대한 메세지에는 원래 메세지의 ID와 동일한 <code>id</code> 필드가 포함됩니다. 이 <code>id</code> 는 서버에서 읽지 않습니다.</p><p>서버에서 클라이언트로 전송하는 대부분의 메세지에는 서버에서 메세지를 생성한 시간을 담고있는 <code>ts</code> 필드가 존재합니다.</p><div id=outline-container-data class=outline-4><h4 id=data><code>{data}</code></h4><div id=outline-text-data class=outline-text-4><p>topic에 있는 콘텐츠를 발송합니다. 이 메세지들은 데이터베이스에 유지되는 유일한 메세지입니다. <code>{data}</code> 메세지들은 topic에 <code>R</code> 권한이 있는 모든 구독자들에게 전송됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>data: {
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic which distributed this message,
</span></span><span class=line><span class=cl>                            // always present
</span></span><span class=line><span class=cl>  from: &#34;usr2il9suCbuko&#34;, // string, id of the user who published the
</span></span><span class=line><span class=cl>                          // message; could be missing if the message was
</span></span><span class=line><span class=cl>                          // generated by the server
</span></span><span class=line><span class=cl>  head: { key: &#34;value&#34;, ... }, // set of string key-value pairs, passed
</span></span><span class=line><span class=cl>                               // unchanged from {pub}, optional
</span></span><span class=line><span class=cl>  ts: &#34;2015-10-06T18:07:30.038Z&#34;, // string, timestamp
</span></span><span class=line><span class=cl>  seq: 123, // integer, server-issued sequential ID
</span></span><span class=line><span class=cl>  content: { ... } // object, application-defined content exactly as published
</span></span><span class=line><span class=cl>              // by the user in the {pub} message
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p>Data 메세지들은 서버에서 생성한 numeric ID를 가지고 있는 <code>seq</code> 필드를 포함하고 있습니다. 이 ID들은 각 topic별로 고유한 숫자들입니다. ID들은 각 topic별로 <a href=#pub><code>{pub}</code></a> 메세지가 성공적으로 전송될 경우 1부터 1씩 증가합니다.</p><p><a href="#Format of Content">Format of Content</a> 섹션을 참고하여 <code>content</code> 필드 구성방법을 확인하세요.</p><p><code>head</code> 필드에 사용할 수 있는 값들에 대해 알고 싶다면 <a href=#pub><code>{pub}</code></a> 메세지를 확인하세요.</p></div></div><div id=outline-container-headline-57 class=outline-4><h4 id=headline-57><code>{ctrl}</code></h4><div id=outline-text-headline-57 class=outline-text-4><p>에러 또는 성공 조건을 나타내는 일반적인 응답입니다. 메세지는 원본 세션으로 전송됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ctrl: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic name, if this is a response in context
</span></span><span class=line><span class=cl>                            // of a topic, optional
</span></span><span class=line><span class=cl>  code: 200, // integer, code indicating success or failure of the request, follows
</span></span><span class=line><span class=cl>             // the HTTP status codes model, always present
</span></span><span class=line><span class=cl>  text: &#34;OK&#34;, // string, text with more details about the result, always present
</span></span><span class=line><span class=cl>  params: { ... }, // object, generic response parameters, context-dependent,
</span></span><span class=line><span class=cl>                   // optional
</span></span><span class=line><span class=cl>  ts: &#34;2015-10-06T18:07:30.038Z&#34;, // string, timestamp
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-58 class=outline-4><h4 id=headline-58><code>{meta}</code></h4><div id=outline-text-headline-58 class=outline-text-4><p>topic이나 구독자에 대한 메타데이터 정보로써, <code>{get}</code>, <code>{set}</code> 또는 <code>{sub}</code> 메세지의 응답으로 원본 세션으로 전송됩니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>meta: {
</span></span><span class=line><span class=cl>  id: &#34;1a2b3&#34;, // string, client-provided message id, optional
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic name, if this is a response in
</span></span><span class=line><span class=cl>                            // context of a topic, optional
</span></span><span class=line><span class=cl>  ts: &#34;2015-10-06T18:07:30.038Z&#34;, // string, timestamp
</span></span><span class=line><span class=cl>  desc: {
</span></span><span class=line><span class=cl>    created: &#34;2015-10-24T10:26:09.716Z&#34;,
</span></span><span class=line><span class=cl>    updated: &#34;2015-10-24T10:26:09.716Z&#34;,
</span></span><span class=line><span class=cl>    status: &#34;ok&#34;, // account status; included for `me` topic only, and only if
</span></span><span class=line><span class=cl>                  // the request is sent by a root-authenticated session.
</span></span><span class=line><span class=cl>    defacs: { // topic&#39;s default access permissions; present only if the current
</span></span><span class=line><span class=cl>              //user has &#39;S&#39; permission
</span></span><span class=line><span class=cl>      auth: &#34;JRWP&#34;, // default access for authenticated users
</span></span><span class=line><span class=cl>      anon: &#34;N&#34; // default access for anonymous users
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    acs: {  // user&#39;s actual access permissions
</span></span><span class=line><span class=cl>      want: &#34;JRWP&#34;, // string, requested access permission
</span></span><span class=line><span class=cl>      given: &#34;JRWP&#34;, // string, granted access permission
</span></span><span class=line><span class=cl>    mode: &#34;JRWP&#34; // string, combination of want and given
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    seq: 123, // integer, server-issued id of the last {data} message
</span></span><span class=line><span class=cl>    read: 112, // integer, ID of the message user claims through {note} message
</span></span><span class=line><span class=cl>              // to have read, optional
</span></span><span class=line><span class=cl>    recv: 115, // integer, like &#39;read&#39;, but received, optional
</span></span><span class=line><span class=cl>    clear: 12, // integer, in case some messages were deleted, the greatest ID
</span></span><span class=line><span class=cl>               // of a deleted message, optional
</span></span><span class=line><span class=cl>    public: { ... }, // application-defined data that&#39;s available to all topic
</span></span><span class=line><span class=cl>                     // subscribers
</span></span><span class=line><span class=cl>    private: { ...} // application-defined data that&#39;s available to the current
</span></span><span class=line><span class=cl>                    // user only
</span></span><span class=line><span class=cl>  }, // object, topic description, optional
</span></span><span class=line><span class=cl>  sub:  [ // array of objects, topic subscribers or user&#39;s subscriptions, optional
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      user: &#34;usr2il9suCbuko&#34;, // string, ID of the user this subscription
</span></span><span class=line><span class=cl>                            // describes, absent when querying &#39;me&#39;.
</span></span><span class=line><span class=cl>      updated: &#34;2015-10-24T10:26:09.716Z&#34;, // timestamp of the last change in the
</span></span><span class=line><span class=cl>                                           // subscription, present only for
</span></span><span class=line><span class=cl>                                           // requester&#39;s own subscriptions
</span></span><span class=line><span class=cl>      touched: &#34;2017-11-02T09:13:55.530Z&#34;, // timestamp of the last message in the
</span></span><span class=line><span class=cl>                                           // topic (may also include other events
</span></span><span class=line><span class=cl>                                           // in the future, such as new subscribers)
</span></span><span class=line><span class=cl>      acs: {  // user&#39;s access permissions
</span></span><span class=line><span class=cl>        want: &#34;JRWP&#34;, // string, requested access permission, present for user&#39;s own
</span></span><span class=line><span class=cl>              // subscriptions and when the requester is topic&#39;s manager or owner
</span></span><span class=line><span class=cl>        given: &#34;JRWP&#34;, // string, granted access permission, optional exactly as &#39;want&#39;
</span></span><span class=line><span class=cl>        mode: &#34;JRWP&#34; // string, combination of want and given
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>      read: 112, // integer, ID of the message user claims through {note} message
</span></span><span class=line><span class=cl>                 // to have read, optional.
</span></span><span class=line><span class=cl>      recv: 315, // integer, like &#39;read&#39;, but received, optional.
</span></span><span class=line><span class=cl>      clear: 12, // integer, in case some messages were deleted, the greatest ID
</span></span><span class=line><span class=cl>                 // of a deleted message, optional.
</span></span><span class=line><span class=cl>      public: { ... }, // application-defined user&#39;s &#39;public&#39; object, absent when
</span></span><span class=line><span class=cl>                       // querying P2P topics.
</span></span><span class=line><span class=cl>      private: { ... } // application-defined user&#39;s &#39;private&#39; object.
</span></span><span class=line><span class=cl>      online: true, // boolean, current online status of the user; if this is a
</span></span><span class=line><span class=cl>                    // group or a p2p topic, it&#39;s user&#39;s online status in the topic,
</span></span><span class=line><span class=cl>                    // i.e. if the user is attached and listening to messages; if this
</span></span><span class=line><span class=cl>                    // is a response to a &#39;me&#39; query, it tells if the topic is
</span></span><span class=line><span class=cl>                    // online; p2p is considered online if the other party is
</span></span><span class=line><span class=cl>                    // online, not necessarily attached to topic; a group topic
</span></span><span class=line><span class=cl>                    // is considered online if it has at least one active
</span></span><span class=line><span class=cl>                    // subscriber.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      // The following fields are present only when querying &#39;me&#39; topic
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic this subscription describes
</span></span><span class=line><span class=cl>      seq: 321, // integer, server-issued id of the last {data} message
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      // The following field is present only when querying &#39;me&#39; topic and the
</span></span><span class=line><span class=cl>      // topic described is a P2P topic
</span></span><span class=line><span class=cl>      seen: { // object, if this is a P2P topic, info on when the peer was last
</span></span><span class=line><span class=cl>              //online
</span></span><span class=line><span class=cl>        when: &#34;2015-10-24T10:26:09.716Z&#34;, // timestamp
</span></span><span class=line><span class=cl>        ua: &#34;Tinode/1.0 (Android 5.1)&#34; // string, user agent of peer&#39;s client
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>  tags: [ // array of tags that the topic or user (in case of &#34;me&#34; topic) is indexed by
</span></span><span class=line><span class=cl>    &#34;email:alice@example.com&#34;, &#34;tel:+1234567890&#34;
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>  cred: [ // array of user&#39;s credentials
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      meth: &#34;email&#34;, // string, validation method
</span></span><span class=line><span class=cl>      val: &#34;alice@example.com&#34;, // string, credential value
</span></span><span class=line><span class=cl>      done: true     // validation status
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    ...
</span></span><span class=line><span class=cl>  ],
</span></span><span class=line><span class=cl>  del: {
</span></span><span class=line><span class=cl>    clear: 3, // ID of the latest applicable &#39;delete&#39; transaction
</span></span><span class=line><span class=cl>    delseq: [{low: 15}, {low: 22, hi: 28}, ...], // ranges of IDs of deleted messages
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div></div><div id=outline-container-headline-59 class=outline-4><h4 id=headline-59><code>{pres}</code></h4><div id=outline-text-headline-59 class=outline-text-4><p>Tinode는 중요한 이벤트를 알릴 때 <code>{pres}</code> 메세지를 사용합니다. <a href="https://docs.google.com/spreadsheets/d/e/2PACX-1vStUDHb7DPrD8tF5eANLu4YIjRkqta8KOhLvcj2precsjqR40eDHvJnnuuS3bw-NcWsP1QKc7GSTYuX/pubhtml?gid=1959642482&amp;single=true">별도의 문서</a>에서 가능한 모든 사용 사례를 설명합니다.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pres: {
</span></span><span class=line><span class=cl>  topic: &#34;me&#34;, // string, topic which receives the notification, always present
</span></span><span class=line><span class=cl>  src: &#34;grp1XUtEhjv6HND&#34;, // string, topic or user affected by the change, always present
</span></span><span class=line><span class=cl>  what: &#34;on&#34;, // string, what&#39;s changed, always present
</span></span><span class=line><span class=cl>  seq: 123, // integer, &#34;what&#34; is &#34;msg&#34;, a server-issued ID of the message,
</span></span><span class=line><span class=cl>            // optional
</span></span><span class=line><span class=cl>  clear: 15, // integer, &#34;what&#34; is &#34;del&#34;, an update to the delete transaction ID.
</span></span><span class=line><span class=cl>  delseq: [{low: 123}, {low: 126, hi: 136}], // array of ranges, &#34;what&#34; is &#34;del&#34;,
</span></span><span class=line><span class=cl>             // ranges of IDs of deleted messages, optional
</span></span><span class=line><span class=cl>  ua: &#34;Tinode/1.0 (Android 2.2)&#34;, // string, a User Agent string identifying client
</span></span><span class=line><span class=cl>             // software if &#34;what&#34; is &#34;on&#34; or &#34;ua&#34;, optional
</span></span><span class=line><span class=cl>  act: &#34;usr2il9suCbuko&#34;,  // string, user who performed the action, optional
</span></span><span class=line><span class=cl>  tgt: &#34;usrRkDVe0PYDOo&#34;,  // string, user affected by the action, optional
</span></span><span class=line><span class=cl>  acs: {want: &#34;+AS-D&#34;, given: &#34;+S&#34;} // object, changes to access mode, &#34;what&#34; is &#34;acs&#34;,
</span></span><span class=line><span class=cl>                          // optional
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div><p><code>{pres}</code> 메세지는 아주 일시적입니다. 메세지는 저장되지 않으며 일시적으로 사용할 수 없을 경우 나중에 재전송을 시도하지 않습니다.</p></div></div><div id=outline-container-headline-60 class=outline-4><h4 id=headline-60><code>{info}</code></h4><div id=outline-text-headline-60 class=outline-text-4><p>클라이언트에서 생성한 <code>{note}</code> 알림입니다. 서버는 메세지가 규격을 준수하고 <code>topic</code> 과 <code>form</code> 필드의 내용이 정확함을 보장합니다. The other content is copied from the <code>{note}</code> message verbatim and may potentially be incorrect or misleading if the originator so desires.</p><div class="src src-text"><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>info: {
</span></span><span class=line><span class=cl>  topic: &#34;grp1XUtEhjv6HND&#34;, // string, topic affected, always present
</span></span><span class=line><span class=cl>  from: &#34;usr2il9suCbuko&#34;, // string, id of the user who published the
</span></span><span class=line><span class=cl>                          // message, always present
</span></span><span class=line><span class=cl>  what: &#34;read&#34;, // string, one of &#34;kp&#34;, &#34;recv&#34;, &#34;read&#34;, see client-side {note},
</span></span><span class=line><span class=cl>                // always present
</span></span><span class=line><span class=cl>  seq: 123, // integer, ID of the message that client has acknowledged,
</span></span><span class=line><span class=cl>            // guaranteed 0 &lt; read &lt;= recv &lt;= {ctrl.params.seq}; present for rcpt &amp;
</span></span><span class=line><span class=cl>            // read
</span></span><span class=line><span class=cl>}</span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>수정: 2021-04-11</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/2020-07-26-tinode-chat-api-doc-translate-ko/index.md target=_blank>마크다운 읽기</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="공유하기 Twitter" data-sharer=twitter data-url=https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/ data-title="tinode series.003 - API document" data-hashtags=tinode,golang,chat><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="공유하기 Facebook" data-sharer=facebook data-url=https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/ data-hashtag=tinode><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="공유하기 Hacker News" data-sharer=hackernews data-url=https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/ data-title="tinode series.003 - API document"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="공유하기 Pocket" data-sharer=pocket data-url=https://yeongcheon.github.io/posts/2020-07-26-tinode-chat-api-doc-translate-ko/><i class="fab fa-get-pocket fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/tinode/>tinode</a>,&nbsp;<a href=/tags/golang/>golang</a>,&nbsp;<a href=/tags/chat/>chat</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>뒤로</a></span>&nbsp;|&nbsp;<span><a href=/>홈</a></span></section></div><div class=post-nav><a href=/posts/2020-06-12-grpc-for-web/ class=prev rel=prev title="gRPC를 웹브라우저에 호출해보자(a.k.a Typescript)"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>gRPC를 웹브라우저에 호출해보자(a.k.a Typescript)</a>
<a href=/posts/2020-09-06-kotlin-spring-exception-rollback/ class=next rel=next title="코틀린으로 작성된 스프링 기반 API 트랜잭션 rollback 관리">코틀린으로 작성된 스프링 기반 API 트랜잭션 rollback 관리<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.118.2">Hugo</a>로 제작된 사이트 | 테마 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/yeongcheon target=_blank>YeongCheon Kim</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="맨 위로"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="댓글 보기"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=https://yeongcheon.disqus.com/embed.js defer></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/contrib/auto-render.min.js></script><script type=text/javascript src=/lib/katex/contrib/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/contrib/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"복사하기",maxShownLines:50},comment:{},cookieconsent:{content:{dismiss:"알겠습니다",link:"더 보기",message:"본 웹사이트는 웹 환경 개선을 위해 쿠키를 사용합니다."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-0YT8RHXZR3",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-0YT8RHXZR3" async></script></body></html>