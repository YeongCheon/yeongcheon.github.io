<!doctype html><html lang=ko><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>Posts - 김영천 블로그</title><meta property="og:title" content="Posts - 김영천 블로그"><meta name=twitter:title content="Posts - 김영천 블로그"><meta name=author content="YeongCheon Kim"><meta property="og:site_name" content="김영천 블로그"><meta property="og:url" content="https://yeongcheon.github.io/posts/"><meta property="og:type" content="website"><meta property="og:image" content="https://yeongcheon.github.io/images/profile_no_background.png"><meta name=twitter:image content="https://yeongcheon.github.io/images/profile_no_background.png"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.82.0"><link href=/posts/index.xml rel=alternate type=application/rss+xml title="김영천 블로그"><link href=/posts/index.xml rel=feed type=application/rss+xml title="김영천 블로그"><link rel=stylesheet href=/css/style.css media=all><link rel=stylesheet href=/css/syntax.css media=all><link rel=stylesheet href=/css/custom.css media=all><script src=/js/script.js></script><script src=/js/custom.js></script><script defer src=/js/fontawesome.js></script></head><body><header class=site-header><nav class=site-navi><h1 class=site-title><a href=/><img src=/images/profile_no_background.png>김영천 블로그 - 게을러지고 싶으면 공부해야 합니다.</a></h1><ul class=site-navi-items><li class=site-navi-item-tags><a href=/tags/ title=Tags>Tags</a></li><li class=site-navi-item-archives><a href=/posts/ title=Archives>Archives</a></li><li class=site-navi-item-about><a href=/about/ title=About>About</a></li></ul></nav></header><hr class=site-header-bottom><div class=breadcrumb>Posts</div><div class=main role=main><section class="list section-list"><article class=article><a href=/posts/2021-02-05-cloud-function-context-problem/ class=article-titles><h2 class=article-title>cloud function 호출 시 context의 중요성에 대해 알아보자.</h2><h3 class=article-subtitle>cloud function을 http trigger로 호출 시 context를 잘못 할당할 경우 발생하는 문제에 대해 알아봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>February 5, 2021</time></li><li class=article-meta-tags><a href=/tags/gcp/><i class="fas fa-tag"></i>
gcp
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/cloudfunction/><i class="fas fa-tag"></i>
cloudfunction
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/golang/><i class="fas fa-tag"></i>
golang
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/context/><i class="fas fa-tag"></i>
context
</a>&nbsp;</li></ul><div class=article-content>예전 글에서 언급한 imagick-cf를 테스트 하는 도중 마주한 알 수 없는 특이한 오류와 이를 해결했던 과정을 기록합니다.
문제 url을 통해서 함수를 실행하면 최초 실행 후 일정 시간동안은 몇번을 호출하든 결과가 정상적으로 반환합니다. 하지만 이후 500 에러를 반환하기 시작합니다. 심지어 이 전에 정상적으로 반환했던 url을 그대로 호출해도 500 error를 반환하는 어처구니 없는 모습을 보여줍니다. 게다가 500 에러를 반환하는 경우엔 로그조차 남지 않아서 원인을 지레짐작으로 파악할 수 밖에 없는 상황입니다.</div><div class=article-readmore><a href=/posts/2021-02-05-cloud-function-context-problem/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-02-03-fix-git-hooks-not-working/ class=article-titles><h2 class=article-title>git hooks 안되는 문제 해결하기</h2><h3 class=article-subtitle>git hooks(pre-commit)이 동작을 안하는 문제를 해결해보아요.</h3></a><ul class=article-meta><li class=article-meta-date><time>February 3, 2021</time></li><li class=article-meta-tags><a href=/tags/git/><i class="fas fa-tag"></i>
git
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/hooks/><i class="fas fa-tag"></i>
hooks
</a>&nbsp;</li></ul><div class=article-content>What 필자는 프로젝트에서 commit을 하기 전에 lint 명령어를 이용해서 코드 스타일을 관리하고 있습니다. 초기에는 commit을 하기 전에 직접 수동으로 lint를 실행해서 코드를 점검해왔지만 아무래도 사람이 하는지라 종종 까먹고 lint 실행을 까먹는 경우가 발생하였습니다. 이 후 이 동작들을 자동화 하기 위해서 git hooks의 pre-commit을 이용하여 자동화를 시켜놨는데 집에서 사용하는 랩탑에서는 pre-commit이 동작하지 않는 문제가 발생하였습니다. 이를 해결하기 위해 열심히 구글링을 해봤지만 답이 나오지 않아 직접 이것저걸 삽질을 진행하다가 문제를 해결하여 이를 기록하고자 합니다.</div><div class=article-readmore><a href=/posts/2021-02-03-fix-git-hooks-not-working/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-02-01-emacs-image-mode-edit-bug/ class=article-titles><h2 class=article-title>emacs에서 svg 수정 안되는 문제 해결하기</h2><h3 class=article-subtitle>특정 조건에서 emacs에서 svg 파일 수정이 안되는 원인과 해결방법을 알아봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>February 1, 2021</time></li><li class=article-meta-tags><a href=/tags/emacs/><i class="fas fa-tag"></i>
emacs
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/svg/><i class="fas fa-tag"></i>
svg
</a>&nbsp;</li></ul><div class=article-content>이맥스에서 svg 파일을 열면 기본적으로 image-mode가 활성화 된 상태로 파일이 열립니다. 이 때 버퍼는 svg 코드가 아니라 렌더링 된 이미지를 보여줍니다. 이미지가 아니라 코드를 보고싶을 경우엔 C-c C-c 단축키를 이용해서 버퍼 상태를 전환해야 합니다. 대부분의 코드 보기 상태에서 별도의 조치 없이 바로 코드 작업을 할 수 있지만 간혹 코드 수정이 안되는 경우가 있습니다. 원인이야 다양할 수 있지만 저같은 경우엔 editorconfig-mode가 문제였습니다. 아래는 제 .emacs 파일의 일부입니다. editorconfig-mode가 기본적으로 활성화 되도록 설정되어 있습니다.</div><div class=article-readmore><a href=/posts/2021-02-01-emacs-image-mode-edit-bug/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-01-26-emacs-typescript-eslint-setting/ class=article-titles><h2 class=article-title>emacs에서 Typescript 개발환경 구축하기</h2><h3 class=article-subtitle>emacs에서 lsp-mode 기반의 Typescript 개발환경을 구축하는 법을 알아봅니다.</h3></a><ul class=article-meta><li class=article-meta-date><time>January 26, 2021</time></li><li class=article-meta-tags><a href=/tags/emacs/><i class="fas fa-tag"></i>
emacs
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/typescript/><i class="fas fa-tag"></i>
typescript
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/lsp-mode/><i class="fas fa-tag"></i>
lsp-mode
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/eslint/><i class="fas fa-tag"></i>
eslint
</a>&nbsp;</li></ul><div class=article-content>Typescript는 마이크로소프트(이하 MS)의 주도로 개발이 되고 있기 때문인지 Vscode에서 아주 편안하게 개발이 가능합니다. 사실 이번 글에서 주로 사용할 lsp-mode도 MS에서 개발한 LSP에 기반하여 작성된 모드입니다. 이 외에도 css languag server 등등 많은 부분을 MS에서 작성한 프로그램에 의존하고 있는데 이쯤되면 그냥 속편하게 Vscode를 쓰는게 낫지 않을까 싶지만 몇년동안 정들었던 이맥스를 포기하기엔 아쉬움이 많이 남기에 Typescript 개발환경 구축 방법을 기록하고자 합니다. 이 글은 다음과 같은 내용을 기준으로 작성되었습니다.
emacs 27.</div><div class=article-readmore><a href=/posts/2021-01-26-emacs-typescript-eslint-setting/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2021-01-06-image-resize-cloud-function/ class=article-titles><h2 class=article-title>Cloud Functions로 실시간 이미지 리사이징 하기</h2><h3 class=article-subtitle>Cloud Functions을 이용해서 On-The-Fly 이미지 리사이징 및 포맷 변경을 해봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>January 6, 2021</time></li><li class=article-meta-tags><a href=/tags/gcp/><i class="fas fa-tag"></i>
gcp
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/cloudfunctions/><i class="fas fa-tag"></i>
cloudfunctions
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/on-the-fly/><i class="fas fa-tag"></i>
on-the-fly
</a>&nbsp;</li></ul><div class=article-content>당근마켓, 비트윈 등에서 작성한 글을 참고하여 GCP 기반으로 비슷한 기능을 하는 코드를 작성하여 봅시다. 동작 원리는 앞서 말한 글에 자세히 나와있으니 서론은 생략하고 바로 시작합니다.
이 문서에서는 GCP의 아래 제품들을 사용합니다.
Cloud Functions
Cloud Stroage
Cloud CDN
Cloud Storage 실제 이미지들이 저장될 storage bucket을 생성해야 합니다. 여기선 특별할게 없으니 공식 가이드로 대체합니다.
Cloud Functions 코드 수정 및 배포 Cloud Function을 호출하는 방법은 여러가지가 있습니다만 이 문서에서는 http 요청을 통해 호출하는 방법을 사용합니다.</div><div class=article-readmore><a href=/posts/2021-01-06-image-resize-cloud-function/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2020-11-26-html-download-property/ class=article-titles><h2 class=article-title>HTML의 download 속성</h2><h3 class=article-subtitle>HTML의 download 속성</h3></a><ul class=article-meta><li class=article-meta-date><time>November 28, 2020</time></li><li class=article-meta-tags><a href=/tags/html/><i class="fas fa-tag"></i>
html
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/a/><i class="fas fa-tag"></i>
a
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/download/><i class="fas fa-tag"></i>
download
</a>&nbsp;</li></ul><div class=article-content><p>특정 파일을 바로 다운받을 수 있는 download 속성에 대해 알아봅시다. 사실 별 내용 없고 그냥 안까먹을 목적으로 작성하는 중입니다. 이 문서보다는 <a href=https://developer.mozilla.org/ko/docs/Web/HTML/Element/a>여기</a>가 더 보기 좋아요.</p><div class="src src-html"><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://imageURL.com&#34;</span> <span style=color:#a6e22e>download</span>&gt;download image&lt;/<span style=color:#f92672>a</span>&gt;</code></pre></td></tr></table></div></div></div></div><div class=article-readmore><a href=/posts/2020-11-26-html-download-property/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2020-09-06-kotlin-spring-exception-rollback/ class=article-titles><h2 class=article-title>코틀린으로 작성된 스프링 기반 API 트랜잭션 rollback 관리</h2><h3 class=article-subtitle>코틀린으로 작성된 스프링 기반 API에서 Checked Exception 발생 시 rollback이 되지 않도록 해봅시다.</h3></a><ul class=article-meta><li class=article-meta-date><time>September 8, 2020</time></li><li class=article-meta-tags><a href=/tags/kotlin/><i class="fas fa-tag"></i>
kotlin
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/spring/><i class="fas fa-tag"></i>
spring
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/exception/><i class="fas fa-tag"></i>
exception
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/transaction/><i class="fas fa-tag"></i>
transaction
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/rollback/><i class="fas fa-tag"></i>
rollback
</a>&nbsp;</li></ul><div class=article-content>Kotlin + Spring boot을 조합해 작성한 REST API에서 CheckedException이 발생해도 Rollback이 되지 않는 문제와 그 해결법에 대해 알아봅시다. 이 글은 Spring, RDB, JPA에 대한 기본적인 이해가 있다는 가정 하에 작성되었습니다.
Checked Exception? 우선 Checked Exception에 대해서 알아봅시다. Kotlin에서 Exception은 크게 두가지로 나눌 수 있습니다.
Checked Exception: 컴파일 시 체크되는 예외입니다. Runtime Exception에 해당되지 않는 모든 Exception은 Checked Exception이 됩니다.
Runtime(Unchecked) Exception: 컴파일 단계에서 체크되지 않으며(Unchecked) 실행 중(Runtime) 발생하는 예외입니다(Ex: IndexOutOfBoundsException, IllegalArgumentException, etc…).</div><div class=article-readmore><a href=/posts/2020-09-06-kotlin-spring-exception-rollback/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2020-07-26-tinode-chat-api-doc-translate-ko/ class=article-titles><h2 class=article-title>tinode series.003 - API document</h2><h3 class=article-subtitle>tinode chat API document 한국어 번역본</h3></a><ul class=article-meta><li class=article-meta-date><time>July 26, 2020</time></li><li class=article-meta-tags><a href=/tags/tinode/><i class="fas fa-tag"></i>
tinode
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/golang/><i class="fas fa-tag"></i>
golang
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/chat/><i class="fas fa-tag"></i>
chat
</a>&nbsp;</li></ul><div class=article-content>매번 영어문서 보기 빡쳐서 직접 번역기 돌려가며 쓰는 번역본. 번역기와 의역, 오역 범벅입니다. 가급적이면 공식 문서를 보세요.
Server API How it works? Tinode는 IM 라우터이자 스토어입니다. 발행-구독 모델 컨셉을 대략적으로 따릅니다.
서버는 세션, 사용자, 그리고 토픽을 연결합니다. 세션은 클라이언트 프로그램과 서버 간의 네트워크 연결을 의미합니다. 사용자는 세션을 서버에 연결하는 사람을 의미합니다. 토픽은 세션들끼리 콘텐츠를 주고받는 통신 채널입니다.
사용자가 토픽은 각각 고유한 ID가 할당됩니다. 사용자 ID는 'usr' 문자로 시작하는 base64-URL 인코딩 6비트 랜덤 문자로 이루어져 있습니다(예: usr2il9suCbuko).</div><div class=article-readmore><a href=/posts/2020-07-26-tinode-chat-api-doc-translate-ko/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2020-06-12-grpc-for-web/ class=article-titles><h2 class=article-title>gRPC를 웹브라우저에 호출해보자(a.k.a Typescript)</h2><h3 class=article-subtitle>Server streaming RPC를 웹브라우저에 호출해보자</h3></a><ul class=article-meta><li class=article-meta-date><time>June 12, 2020</time></li><li class=article-meta-tags><a href=/tags/grpc/><i class="fas fa-tag"></i>
gRPC
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/envoy/><i class="fas fa-tag"></i>
envoy
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/typescript/><i class="fas fa-tag"></i>
typescript
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/golang/><i class="fas fa-tag"></i>
golang
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/server-stream/><i class="fas fa-tag"></i>
server-stream
</a>&nbsp;</li></ul><div class=article-content>목표 브라우저에서 rpc를 호출하고 싶습니다. 하지만 2020년 7월 기준으로 브라우저에서 gRPC의 rpc를 직접 호출하는 건 불가능합니다. 그치만 envoy Proxy와 함께라면 가능합니다. 이 문서에서는 grpc-web을 이용해 생성된 Typescript 파일을 이용해 server streaming rpc를 호출하는 방법을 설명합니다. 서버는 Go, 클라이언트는 Typescript 언어를 사용합니다.
proto 파일 작성 특정 채팅방에 접속해서 server stream을 얻는 rpc를 작성해봅시다. 양방향 스트림이 아니라 서버사이드 스트림으로 한 이유는 현재 grpc-web에서는 양방향 스트림을 지원하지 않기 때문입니다(클라이언트 스트림도 지원하지 않습니다).</div><div class=article-readmore><a href=/posts/2020-06-12-grpc-for-web/>Read more...</a></div><div class=article-floatclear></div></article><article class=article><a href=/posts/2020-05-30-grpc-interceptor/ class=article-titles><h2 class=article-title>gRPC interceptor</h2><h3 class=article-subtitle>grpc unary,stream interceptor 적용</h3></a><ul class=article-meta><li class=article-meta-date><time>May 30, 2020</time></li><li class=article-meta-tags><a href=/tags/grpc/><i class="fas fa-tag"></i>
grpc
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/golang/><i class="fas fa-tag"></i>
golang
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/unary/><i class="fas fa-tag"></i>
unary
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/stream/><i class="fas fa-tag"></i>
stream
</a>&nbsp;</li><li class=article-meta-tags><a href=/tags/interceptor/><i class="fas fa-tag"></i>
interceptor
</a>&nbsp;</li></ul><div class=article-content>이 문서는 grpc-go Interceptor 문서를 번역한 것입니다(대부분 번역기 발췌, 작성자는 영어를 되게 못해요).
Interceptor gRPC는 clientConn/server 단위로 인터셉터를 구현하고 설치할 수 있는 간단한 API를 제공합니다. 인터셉터는 각 RPC 호출을 중간에서 가로채는 역할을 합니다. 사용자는 인터셉터를 사용하여 로깅, 인증/권한부여, 메트릭 수집 등 RPC 전체를 아우르는 공용 기능을 수행할 수 있습니다.
Try it 1 go run server/main.go 1 go run client/main.go Explanation gRPC에서 인터셉터는 RPC 호출 유형에 따라 크게 두 가지로 구분할 수 있습니다.</div><div class=article-readmore><a href=/posts/2020-05-30-grpc-interceptor/>Read more...</a></div><div class=article-floatclear></div></article></section><ul class=pagination><li class=page-item><a href=/posts/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class="page-item disabled"><a class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class="page-item active"><a class=page-link href=/posts/>1</a></li><li class=page-item><a class=page-link href=/posts/page/2/>2</a></li><li class=page-item><a class=page-link href=/posts/page/3/>3</a></li><li class=page-item><a class=page-link href=/posts/page/4/>4</a></li><li class=page-item><a href=/posts/page/2/ class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/posts/page/4/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div><div class=site-footer><div class=copyright>&copy; Copyright 2020 YeongCheon</div><ul class=site-footer-items><li class=site-footer-item-rsslink><a href=/posts/index.xml type=application/rss+xml target=_blank title=RSS><i class="fas fa-rss"></i></a></li><li class=site-footer-item-about><a href=/about/ title=About>About</a></li></ul><div class=powerdby>Powered by <a href=https://gohugo.io/>Hugo</a> and <a href=https://github.com/taikii/whiteplain>Whiteplain</a></div></div><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-135478508-1','auto'),ga('send','pageview'))</script></body><script data-ad-client=ca-pub-4599234083355765 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></html>